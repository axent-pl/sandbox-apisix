_format_version: '2.1'
_transform: true
plugins:
- name: tcp-log
  config:
    host: kong-etl
    port: 1111
- name: prometheus
  config:
    latency_metrics: true
    upstream_health_metrics: true
    per_consumer: true
    status_code_metrics: true
    bandwidth_metrics: true
consumers:
- username: jwt-consumer
  custom_id: jwt-consumer-id
  jwt_secrets:
  - algorithm: RS256
    key: http://localhost:2380/auth/realms/bank
    rsa_public_key: '-----BEGIN PUBLIC KEY-----

      MIICIjANBgkqhkiG9w0BAQEFAAOCAg8AMIICCgKCAgEAqi32ruIMLgsLhePY2lqRBo+1YnNrE7NyE827lWyEgH1zfI+WKktlH9rOiSt4wZOgHVCg9B0QNSipXkqfV9HxfSBi6KIkkxtpAErFGbhK4vTYooKNDgkCZ0A6U7jqW1l2HtzxHm5UyVnedW/lmqJmX2D4XMkWlX6FmoAXkOa9Si+qwGJTaDhVHx7B4OfmsNPIcia20ujrzoha6c1L4Na2bxt9XyQPt1M873brHgKqN7qc2VCFS212qb3PwBRjl8WA4M7UoWxMkyZAoHbLjdZksZJ1vE4pASfNo0rRo0awLNSE7pjy/9pdoJ4rSKw1s4Ww6E7FEUVSvMoffVnaEuQv6uZOmK1B6ixkaER0NYzlubHUIZhwO9fQHwTgYv9YUoD9X2O9WZDB2+DlkazToem+wO7nJ562o8zXGi4zGEm9lP54mA5tyyJqbmOoAA4bZpWaphiMxx07vwULlRMFapIwbRbMsHnjBbe0VkRl21dyqbIW8yracSql0YhKohnovEDhh6McuPuGqsxAsrjR5V7KBDF6Xp37f//JSKNhym1jVf7F6Mi6bYhy2eIF9CKrYRC5aFWg0f08sMiGiepsBWeo16hocI2Ec0kMZPKDGoA+OpSIy77ZZUO8zGVYk7Uqup7vnQfCS/oREGsLwOYG879ajqlguNFNC4ZIP0HCrnC7bb8CAwEAAQ==

      -----END PUBLIC KEY-----'
services:
- name: presto-birman
  url: http://httpgobin:8080
  routes:
  - name: presto-birman-route-create
    hosts:
    - presto-birman.gateway.bank
    paths:
    - /anything
    strip_path: false
    methods:
    - POST
  - name: presto-birman-route-read
    hosts:
    - presto-birman.gateway.bank
    paths:
    - /anything/(?<resource>\w+)
    strip_path: false
    methods:
    - GET
    plugins:
    - name: jwt
      config:
        claims_to_verify:
        - exp
    - name: request-transformer
      config:
        replace:
          uri: /anything/prefixed-$(uri_captures['resource'])
  - name: presto-birman-route-update
    hosts:
    - presto-birman.gateway.bank
    paths:
    - /anything/(?<resource>\w+)
    strip_path: false
    methods:
    - PUT
    plugins:
    - name: jwt
      config:
        claims_to_verify:
        - exp
    - name: request-transformer
      config:
        replace:
          uri: /anything/prefixed-$(uri_captures['resource'])
  - name: presto-birman-route-list
    hosts:
    - presto-birman.gateway.bank
    paths:
    - /anything
    strip_path: false
    methods:
    - GET
- name: largo-paste
  url: http://httpgobin:8080
  routes:
  - name: largo-paste-route-create
    hosts:
    - largo-paste.gateway.bank
    paths:
    - /anything
    strip_path: false
    methods:
    - POST
  - name: largo-paste-route-read
    hosts:
    - largo-paste.gateway.bank
    paths:
    - /anything/(?<resource>\w+)
    strip_path: false
    methods:
    - GET
    plugins:
    - name: jwt
      config:
        claims_to_verify:
        - exp
    - name: request-transformer
      config:
        replace:
          uri: /anything/prefixed-$(uri_captures['resource'])
  - name: largo-paste-route-update
    hosts:
    - largo-paste.gateway.bank
    paths:
    - /anything/(?<resource>\w+)
    strip_path: false
    methods:
    - PUT
    plugins:
    - name: jwt
      config:
        claims_to_verify:
        - exp
    - name: request-transformer
      config:
        replace:
          uri: /anything/prefixed-$(uri_captures['resource'])
  - name: largo-paste-route-list
    hosts:
    - largo-paste.gateway.bank
    paths:
    - /anything
    strip_path: false
    methods:
    - GET
- name: legato-crumble
  url: http://httpgobin:8080
  routes:
  - name: legato-crumble-route-create
    hosts:
    - legato-crumble.gateway.bank
    paths:
    - /anything
    strip_path: false
    methods:
    - POST
  - name: legato-crumble-route-read
    hosts:
    - legato-crumble.gateway.bank
    paths:
    - /anything/(?<resource>\w+)
    strip_path: false
    methods:
    - GET
    plugins:
    - name: jwt
      config:
        claims_to_verify:
        - exp
    - name: request-transformer
      config:
        replace:
          uri: /anything/prefixed-$(uri_captures['resource'])
  - name: legato-crumble-route-update
    hosts:
    - legato-crumble.gateway.bank
    paths:
    - /anything/(?<resource>\w+)
    strip_path: false
    methods:
    - PUT
    plugins:
    - name: jwt
      config:
        claims_to_verify:
        - exp
    - name: request-transformer
      config:
        replace:
          uri: /anything/prefixed-$(uri_captures['resource'])
  - name: legato-crumble-route-list
    hosts:
    - legato-crumble.gateway.bank
    paths:
    - /anything
    strip_path: false
    methods:
    - GET
- name: grandioso-himalayan
  url: http://httpgobin:8080
  routes:
  - name: grandioso-himalayan-route-create
    hosts:
    - grandioso-himalayan.gateway.bank
    paths:
    - /anything
    strip_path: false
    methods:
    - POST
  - name: grandioso-himalayan-route-read
    hosts:
    - grandioso-himalayan.gateway.bank
    paths:
    - /anything/(?<resource>\w+)
    strip_path: false
    methods:
    - GET
    plugins:
    - name: jwt
      config:
        claims_to_verify:
        - exp
    - name: request-transformer
      config:
        replace:
          uri: /anything/prefixed-$(uri_captures['resource'])
  - name: grandioso-himalayan-route-update
    hosts:
    - grandioso-himalayan.gateway.bank
    paths:
    - /anything/(?<resource>\w+)
    strip_path: false
    methods:
    - PUT
    plugins:
    - name: jwt
      config:
        claims_to_verify:
        - exp
    - name: request-transformer
      config:
        replace:
          uri: /anything/prefixed-$(uri_captures['resource'])
  - name: grandioso-himalayan-route-list
    hosts:
    - grandioso-himalayan.gateway.bank
    paths:
    - /anything
    strip_path: false
    methods:
    - GET
- name: presto-bread
  url: http://httpgobin:8080
  routes:
  - name: presto-bread-route-create
    hosts:
    - presto-bread.gateway.bank
    paths:
    - /anything
    strip_path: false
    methods:
    - POST
  - name: presto-bread-route-read
    hosts:
    - presto-bread.gateway.bank
    paths:
    - /anything/(?<resource>\w+)
    strip_path: false
    methods:
    - GET
    plugins:
    - name: jwt
      config:
        claims_to_verify:
        - exp
    - name: request-transformer
      config:
        replace:
          uri: /anything/prefixed-$(uri_captures['resource'])
  - name: presto-bread-route-update
    hosts:
    - presto-bread.gateway.bank
    paths:
    - /anything/(?<resource>\w+)
    strip_path: false
    methods:
    - PUT
    plugins:
    - name: jwt
      config:
        claims_to_verify:
        - exp
    - name: request-transformer
      config:
        replace:
          uri: /anything/prefixed-$(uri_captures['resource'])
  - name: presto-bread-route-list
    hosts:
    - presto-bread.gateway.bank
    paths:
    - /anything
    strip_path: false
    methods:
    - GET
- name: libretto-olive
  url: http://httpgobin:8080
  routes:
  - name: libretto-olive-route-create
    hosts:
    - libretto-olive.gateway.bank
    paths:
    - /anything
    strip_path: false
    methods:
    - POST
  - name: libretto-olive-route-read
    hosts:
    - libretto-olive.gateway.bank
    paths:
    - /anything/(?<resource>\w+)
    strip_path: false
    methods:
    - GET
    plugins:
    - name: jwt
      config:
        claims_to_verify:
        - exp
    - name: request-transformer
      config:
        replace:
          uri: /anything/prefixed-$(uri_captures['resource'])
  - name: libretto-olive-route-update
    hosts:
    - libretto-olive.gateway.bank
    paths:
    - /anything/(?<resource>\w+)
    strip_path: false
    methods:
    - PUT
    plugins:
    - name: jwt
      config:
        claims_to_verify:
        - exp
    - name: request-transformer
      config:
        replace:
          uri: /anything/prefixed-$(uri_captures['resource'])
  - name: libretto-olive-route-list
    hosts:
    - libretto-olive.gateway.bank
    paths:
    - /anything
    strip_path: false
    methods:
    - GET
- name: libretto-sopapillas
  url: http://httpgobin:8080
  routes:
  - name: libretto-sopapillas-route-create
    hosts:
    - libretto-sopapillas.gateway.bank
    paths:
    - /anything
    strip_path: false
    methods:
    - POST
  - name: libretto-sopapillas-route-read
    hosts:
    - libretto-sopapillas.gateway.bank
    paths:
    - /anything/(?<resource>\w+)
    strip_path: false
    methods:
    - GET
    plugins:
    - name: jwt
      config:
        claims_to_verify:
        - exp
    - name: request-transformer
      config:
        replace:
          uri: /anything/prefixed-$(uri_captures['resource'])
  - name: libretto-sopapillas-route-update
    hosts:
    - libretto-sopapillas.gateway.bank
    paths:
    - /anything/(?<resource>\w+)
    strip_path: false
    methods:
    - PUT
    plugins:
    - name: jwt
      config:
        claims_to_verify:
        - exp
    - name: request-transformer
      config:
        replace:
          uri: /anything/prefixed-$(uri_captures['resource'])
  - name: libretto-sopapillas-route-list
    hosts:
    - libretto-sopapillas.gateway.bank
    paths:
    - /anything
    strip_path: false
    methods:
    - GET
- name: andante-persian
  url: http://httpgobin:8080
  routes:
  - name: andante-persian-route-create
    hosts:
    - andante-persian.gateway.bank
    paths:
    - /anything
    strip_path: false
    methods:
    - POST
  - name: andante-persian-route-read
    hosts:
    - andante-persian.gateway.bank
    paths:
    - /anything/(?<resource>\w+)
    strip_path: false
    methods:
    - GET
    plugins:
    - name: jwt
      config:
        claims_to_verify:
        - exp
    - name: request-transformer
      config:
        replace:
          uri: /anything/prefixed-$(uri_captures['resource'])
  - name: andante-persian-route-update
    hosts:
    - andante-persian.gateway.bank
    paths:
    - /anything/(?<resource>\w+)
    strip_path: false
    methods:
    - PUT
    plugins:
    - name: jwt
      config:
        claims_to_verify:
        - exp
    - name: request-transformer
      config:
        replace:
          uri: /anything/prefixed-$(uri_captures['resource'])
  - name: andante-persian-route-list
    hosts:
    - andante-persian.gateway.bank
    paths:
    - /anything
    strip_path: false
    methods:
    - GET
- name: libretto-steak
  url: http://httpgobin:8080
  routes:
  - name: libretto-steak-route-create
    hosts:
    - libretto-steak.gateway.bank
    paths:
    - /anything
    strip_path: false
    methods:
    - POST
  - name: libretto-steak-route-read
    hosts:
    - libretto-steak.gateway.bank
    paths:
    - /anything/(?<resource>\w+)
    strip_path: false
    methods:
    - GET
    plugins:
    - name: jwt
      config:
        claims_to_verify:
        - exp
    - name: request-transformer
      config:
        replace:
          uri: /anything/prefixed-$(uri_captures['resource'])
  - name: libretto-steak-route-update
    hosts:
    - libretto-steak.gateway.bank
    paths:
    - /anything/(?<resource>\w+)
    strip_path: false
    methods:
    - PUT
    plugins:
    - name: jwt
      config:
        claims_to_verify:
        - exp
    - name: request-transformer
      config:
        replace:
          uri: /anything/prefixed-$(uri_captures['resource'])
  - name: libretto-steak-route-list
    hosts:
    - libretto-steak.gateway.bank
    paths:
    - /anything
    strip_path: false
    methods:
    - GET
- name: moderato-pot
  url: http://httpgobin:8080
  routes:
  - name: moderato-pot-route-create
    hosts:
    - moderato-pot.gateway.bank
    paths:
    - /anything
    strip_path: false
    methods:
    - POST
  - name: moderato-pot-route-read
    hosts:
    - moderato-pot.gateway.bank
    paths:
    - /anything/(?<resource>\w+)
    strip_path: false
    methods:
    - GET
    plugins:
    - name: jwt
      config:
        claims_to_verify:
        - exp
    - name: request-transformer
      config:
        replace:
          uri: /anything/prefixed-$(uri_captures['resource'])
  - name: moderato-pot-route-update
    hosts:
    - moderato-pot.gateway.bank
    paths:
    - /anything/(?<resource>\w+)
    strip_path: false
    methods:
    - PUT
    plugins:
    - name: jwt
      config:
        claims_to_verify:
        - exp
    - name: request-transformer
      config:
        replace:
          uri: /anything/prefixed-$(uri_captures['resource'])
  - name: moderato-pot-route-list
    hosts:
    - moderato-pot.gateway.bank
    paths:
    - /anything
    strip_path: false
    methods:
    - GET
