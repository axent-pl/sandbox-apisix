{"plugins":{"grpc-transcode":{"schema":{"properties":{"method":{"type":"string","description":"the method name in the grpc service."},"service":{"type":"string","description":"the grpc service name"},"status_detail_type":{"type":"string","description":"the message type of the grpc-status-details-bin's details part, if not given, the details part will not be decoded"},"pb_option":{"items":{"anyOf":[{"type":"string","enum":["int64_as_number","int64_as_string","int64_as_hexstring"],"description":"enum as result"},{"type":"string","enum":["enum_as_name","enum_as_value"],"description":"int64 as result"},{"type":"string","enum":["auto_default_values","no_default_values","use_default_values","use_default_metatable"],"description":"default values option"},{"type":"string","enum":["enable_hooks","disable_hooks"],"description":"hooks option"}],"type":"string"},"type":"array","minItems":1,"default":["enum_as_name","int64_as_number","auto_default_values","disable_hooks"]},"deadline":{"type":"number","default":0,"description":"deadline for grpc, millisecond"},"show_status_in_body":{"type":"boolean","default":false,"description":"show decoded grpc-status-details-bin in response body"},"_meta":{"properties":{"disable":{"type":"boolean"},"priority":{"type":"integer","description":"priority of plugins by customized order"},"filter":{"type":"array","description":"filter determines whether the plugin needs to be executed at runtime"},"error_response":{"oneOf":[{"type":"string"},{"type":"object"}]}},"type":"object"},"proto_id":{"anyOf":[{"pattern":"^[a-zA-Z0-9-_.]+$","type":"string","minLength":1,"maxLength":64},{"minimum":1,"type":"integer"}]}},"$comment":"this is a mark for our injected plugin schema","required":["proto_id","service","method"],"additionalProperties":true,"type":"object"},"priority":506,"version":0.1},"file-logger":{"metadata_schema":{"properties":{"log_format":{"type":"object"}},"type":"object"},"schema":{"properties":{"include_resp_body":{"default":false,"type":"boolean"},"match":{"maxItems":20,"type":"array","items":{"type":"array"}},"_meta":{"properties":{"disable":{"type":"boolean"},"priority":{"type":"integer","description":"priority of plugins by customized order"},"filter":{"type":"array","description":"filter determines whether the plugin needs to be executed at runtime"},"error_response":{"oneOf":[{"type":"string"},{"type":"object"}]}},"type":"object"},"include_req_body":{"default":false,"type":"boolean"},"include_resp_body_expr":{"items":{"type":"array"},"type":"array","minItems":1},"include_req_body_expr":{"items":{"type":"array"},"type":"array","minItems":1},"log_format":{"type":"object"},"path":{"type":"string"}},"$comment":"this is a mark for our injected plugin schema","type":"object","required":["path"]},"priority":399,"version":0.1},"http-logger":{"metadata_schema":{"properties":{"log_format":{"type":"object"}},"type":"object"},"schema":{"properties":{"include_req_body":{"default":false,"type":"boolean"},"retry_delay":{"type":"integer","minimum":0,"default":1},"buffer_duration":{"type":"integer","minimum":1,"default":60},"log_format":{"type":"object"},"batch_max_size":{"type":"integer","minimum":1,"default":1000},"uri":{"pattern":"^[^\\/]+:\\/\\/([\\da-zA-Z.-]+|\\[[\\da-fA-F:]+\\])(:\\d+)?","type":"string"},"ssl_verify":{"default":false,"type":"boolean"},"auth_header":{"type":"string"},"concat_method":{"type":"string","default":"json","enum":["json","new_line"]},"include_resp_body_expr":{"items":{"type":"array"},"type":"array","minItems":1},"include_resp_body":{"default":false,"type":"boolean"},"name":{"default":"http logger","type":"string"},"timeout":{"type":"integer","minimum":1,"default":3},"include_req_body_expr":{"items":{"type":"array"},"type":"array","minItems":1},"inactive_timeout":{"type":"integer","minimum":1,"default":5},"_meta":{"properties":{"disable":{"type":"boolean"},"priority":{"type":"integer","description":"priority of plugins by customized order"},"filter":{"type":"array","description":"filter determines whether the plugin needs to be executed at runtime"},"error_response":{"oneOf":[{"type":"string"},{"type":"object"}]}},"type":"object"},"max_retry_count":{"type":"integer","minimum":0,"default":0}},"$comment":"this is a mark for our injected plugin schema","type":"object","required":["uri"]},"priority":410,"version":0.1},"key-auth":{"consumer_schema":{"encrypt_fields":["key"],"type":"object","required":["key"],"properties":{"key":{"type":"string"}}},"priority":2500,"version":0.1,"type":"auth","schema":{"$comment":"this is a mark for our injected plugin schema","type":"object","properties":{"_meta":{"properties":{"disable":{"type":"boolean"},"priority":{"type":"integer","description":"priority of plugins by customized order"},"filter":{"type":"array","description":"filter determines whether the plugin needs to be executed at runtime"},"error_response":{"oneOf":[{"type":"string"},{"type":"object"}]}},"type":"object"},"hide_credentials":{"default":false,"type":"boolean"},"query":{"default":"apikey","type":"string"},"header":{"default":"apikey","type":"string"}}}},"authz-keycloak":{"schema":{"$comment":"this is a mark for our injected plugin schema","properties":{"access_token_expires_leeway":{"type":"integer","minimum":0,"default":0},"refresh_token_expires_in":{"type":"integer","minimum":1,"default":3600},"refresh_token_expires_leeway":{"type":"integer","minimum":0,"default":0},"_meta":{"properties":{"disable":{"type":"boolean"},"priority":{"type":"integer","description":"priority of plugins by customized order"},"filter":{"type":"array","description":"filter determines whether the plugin needs to be executed at runtime"},"error_response":{"oneOf":[{"type":"string"},{"type":"object"}]}},"type":"object"},"password_grant_token_generation_incoming_uri":{"type":"string","minLength":1,"maxLength":4096},"ssl_verify":{"default":true,"type":"boolean"},"access_token_expires_in":{"type":"integer","minimum":1,"default":300},"client_id":{"type":"string","minLength":1,"maxLength":100},"keepalive_timeout":{"type":"integer","minimum":1000,"default":60000},"keepalive_pool":{"type":"integer","minimum":1,"default":5},"token_endpoint":{"type":"string","minLength":1,"maxLength":4096},"resource_registration_endpoint":{"type":"string","minLength":1,"maxLength":4096},"client_secret":{"type":"string","minLength":1,"maxLength":100},"grant_type":{"enum":["urn:ietf:params:oauth:grant-type:uma-ticket"],"default":"urn:ietf:params:oauth:grant-type:uma-ticket","type":"string","minLength":1,"maxLength":100},"discovery":{"type":"string","minLength":1,"maxLength":4096},"permissions":{"items":{"type":"string","minLength":1,"maxLength":100},"type":"array","uniqueItems":true,"default":{}},"policy_enforcement_mode":{"enum":["ENFORCING","PERMISSIVE"],"default":"ENFORCING","type":"string"},"timeout":{"type":"integer","minimum":1000,"default":3000},"lazy_load_paths":{"default":false,"type":"boolean"},"http_method_as_scope":{"default":false,"type":"boolean"},"cache_ttl_seconds":{"type":"integer","minimum":1,"default":86400},"access_denied_redirect_uri":{"type":"string","minLength":1,"maxLength":2048},"keepalive":{"default":true,"type":"boolean"}},"encrypt_fields":["client_secret"],"type":"object","allOf":[{"anyOf":[{"required":["discovery"]},{"required":["token_endpoint"]}]},{"anyOf":[{"properties":{"lazy_load_paths":{"enum":[false]}}},{"anyOf":[{"required":["discovery"]},{"required":["resource_registration_endpoint"]}],"properties":{"lazy_load_paths":{"enum":[true]}}}]}],"required":["client_id"]},"priority":2000,"version":0.1},"jwt-auth":{"consumer_schema":{"dependencies":{"algorithm":{"oneOf":[{"properties":{"algorithm":{"default":"HS256","enum":["HS256","HS512"]}}},{"required":["public_key","private_key"],"properties":{"algorithm":{"enum":["RS256","ES256"]},"public_key":{"type":"string"},"private_key":{"type":"string"}}}]}},"properties":{"secret":{"type":"string"},"base64_secret":{"default":false,"type":"boolean"},"exp":{"type":"integer","minimum":1,"default":86400},"lifetime_grace_period":{"type":"integer","minimum":0,"default":0},"key":{"type":"string"},"algorithm":{"enum":["HS256","HS512","RS256","ES256"],"default":"HS256","type":"string"}},"encrypt_fields":["secret","private_key"],"type":"object","required":["key"]},"priority":2510,"version":0.1,"type":"auth","schema":{"$comment":"this is a mark for our injected plugin schema","type":"object","properties":{"header":{"default":"authorization","type":"string"},"_meta":{"properties":{"disable":{"type":"boolean"},"priority":{"type":"integer","description":"priority of plugins by customized order"},"filter":{"type":"array","description":"filter determines whether the plugin needs to be executed at runtime"},"error_response":{"oneOf":[{"type":"string"},{"type":"object"}]}},"type":"object"},"query":{"default":"jwt","type":"string"},"cookie":{"default":"jwt","type":"string"},"hide_credentials":{"default":false,"type":"boolean"}}}},"wolf-rbac":{"type":"auth","priority":2555,"schema":{"$comment":"this is a mark for our injected plugin schema","type":"object","properties":{"_meta":{"properties":{"disable":{"type":"boolean"},"priority":{"type":"integer","description":"priority of plugins by customized order"},"filter":{"type":"array","description":"filter determines whether the plugin needs to be executed at runtime"},"error_response":{"oneOf":[{"type":"string"},{"type":"object"}]}},"type":"object"},"header_prefix":{"default":"X-","type":"string"},"appid":{"default":"unset","type":"string"},"server":{"default":"http://127.0.0.1:12180","type":"string"}}},"version":0.1},"syslog":{"priority":401,"metadata_schema":{"properties":{"log_format":{"type":"object"}},"type":"object"},"schema":{"$comment":"this is a mark for our injected plugin schema","type":"object","required":["host","port"],"properties":{"include_req_body":{"default":false,"type":"boolean"},"retry_delay":{"type":"integer","minimum":0,"default":1},"buffer_duration":{"type":"integer","minimum":1,"default":60},"log_format":{"type":"object"},"port":{"type":"integer"},"batch_max_size":{"type":"integer","minimum":1,"default":1000},"pool_size":{"type":"integer","minimum":5,"default":5},"flush_limit":{"type":"integer","minimum":1,"default":4096},"drop_limit":{"default":1048576,"type":"integer"},"host":{"type":"string"},"tls":{"default":false,"type":"boolean"},"name":{"default":"sys logger","type":"string"},"sock_type":{"type":"string","default":"tcp","enum":["tcp","udp"]},"timeout":{"type":"integer","minimum":1,"default":3000},"inactive_timeout":{"type":"integer","minimum":1,"default":5},"_meta":{"properties":{"disable":{"type":"boolean"},"priority":{"type":"integer","description":"priority of plugins by customized order"},"filter":{"type":"array","description":"filter determines whether the plugin needs to be executed at runtime"},"error_response":{"oneOf":[{"type":"string"},{"type":"object"}]}},"type":"object"},"max_retry_count":{"type":"integer","minimum":0,"default":0}}},"version":0.1},"response-rewrite":{"schema":{"dependencies":{"filters":{"not":{"required":["body"]}},"body":{"not":{"required":["filters"]}}},"type":"object","$comment":"this is a mark for our injected plugin schema","properties":{"_meta":{"properties":{"disable":{"type":"boolean"},"priority":{"type":"integer","description":"priority of plugins by customized order"},"filter":{"type":"array","description":"filter determines whether the plugin needs to be executed at runtime"},"error_response":{"oneOf":[{"type":"string"},{"type":"object"}]}},"type":"object"},"headers":{"anyOf":[{"type":"object","patternProperties":{"^[^:]+$":{"oneOf":[{"type":"string"},{"type":"number"}]}},"minProperties":1},{"properties":{"add":{"items":{"pattern":"^[^:]+:[^:]*[^/]$","type":"string"},"type":"array","minItems":1},"remove":{"items":{"pattern":"^[^:]+$","type":"string"},"type":"array","minItems":1},"set":{"type":"object","patternProperties":{"^[^:]+$":{"oneOf":[{"type":"string"},{"type":"number"}]}},"minProperties":1}}}],"description":"new headers for response"},"body":{"type":"string","description":"new body for response"},"vars":{"type":"array"},"body_base64":{"type":"boolean","default":false,"description":"whether new body for response need base64 decode before return"},"filters":{"items":{"properties":{"regex":{"type":"string","minLength":1,"description":"match pattern on response body"},"options":{"type":"string","default":"jo","description":"regex options"},"replace":{"type":"string","description":"regex substitution content"},"scope":{"enum":["once","global"],"type":"string","default":"once","description":"regex substitution range"}},"type":"object","required":["regex","replace"],"description":"filter that modifies response body"},"type":"array","minItems":1,"description":"a group of filters that modify response bodyby replacing one specified string by another"},"status_code":{"maximum":598,"type":"integer","minimum":200,"description":"new status code for response"}}},"priority":899,"version":0.1},"limit-conn":{"schema":{"$comment":"this is a mark for our injected plugin schema","type":"object","required":["conn","burst","default_conn_delay","key"],"properties":{"conn":{"exclusiveMinimum":0,"type":"integer"},"rejected_code":{"default":503,"type":"integer","minimum":200,"maximum":599},"rejected_msg":{"minLength":1,"type":"string"},"allow_degradation":{"default":false,"type":"boolean"},"key":{"type":"string"},"_meta":{"properties":{"disable":{"type":"boolean"},"priority":{"type":"integer","description":"priority of plugins by customized order"},"filter":{"type":"array","description":"filter determines whether the plugin needs to be executed at runtime"},"error_response":{"oneOf":[{"type":"string"},{"type":"object"}]}},"type":"object"},"burst":{"minimum":0,"type":"integer"},"default_conn_delay":{"exclusiveMinimum":0,"type":"number"},"only_use_default_delay":{"default":false,"type":"boolean"},"key_type":{"enum":["var","var_combination"],"default":"var","type":"string"}}},"priority":1003,"version":0.1},"serverless-pre-function":{"schema":{"$comment":"this is a mark for our injected plugin schema","type":"object","required":["functions"],"properties":{"_meta":{"properties":{"disable":{"type":"boolean"},"priority":{"type":"integer","description":"priority of plugins by customized order"},"filter":{"type":"array","description":"filter determines whether the plugin needs to be executed at runtime"},"error_response":{"oneOf":[{"type":"string"},{"type":"object"}]}},"type":"object"},"phase":{"type":"string","default":"access","enum":["rewrite","access","header_filter","body_filter","log","before_proxy"]},"functions":{"items":{"type":"string"},"type":"array","minItems":1}}},"priority":10000,"version":0.1},"prometheus":{"priority":500,"schema":{"$comment":"this is a mark for our injected plugin schema","type":"object","properties":{"prefer_name":{"default":false,"type":"boolean"},"_meta":{"properties":{"disable":{"type":"boolean"},"priority":{"type":"integer","description":"priority of plugins by customized order"},"filter":{"type":"array","description":"filter determines whether the plugin needs to be executed at runtime"},"error_response":{"oneOf":[{"type":"string"},{"type":"object"}]}},"type":"object"}}},"version":0.2},"udp-logger":{"priority":400,"metadata_schema":{"properties":{"log_format":{"type":"object"}},"type":"object"},"schema":{"$comment":"this is a mark for our injected plugin schema","type":"object","required":["host","port"],"properties":{"host":{"type":"string"},"max_retry_count":{"type":"integer","minimum":0,"default":0},"retry_delay":{"type":"integer","minimum":0,"default":1},"timeout":{"type":"integer","minimum":1,"default":3},"log_format":{"type":"object"},"port":{"minimum":0,"type":"integer"},"batch_max_size":{"type":"integer","minimum":1,"default":1000},"name":{"default":"udp logger","type":"string"},"buffer_duration":{"type":"integer","minimum":1,"default":60},"inactive_timeout":{"type":"integer","minimum":1,"default":5},"_meta":{"properties":{"disable":{"type":"boolean"},"priority":{"type":"integer","description":"priority of plugins by customized order"},"filter":{"type":"array","description":"filter determines whether the plugin needs to be executed at runtime"},"error_response":{"oneOf":[{"type":"string"},{"type":"object"}]}},"type":"object"},"include_req_body":{"default":false,"type":"boolean"}}},"version":0.1},"ip-restriction":{"schema":{"oneOf":[{"required":["whitelist"]},{"required":["blacklist"]}],"type":"object","$comment":"this is a mark for our injected plugin schema","properties":{"message":{"default":"Your IP address is not allowed","type":"string","minLength":1,"maxLength":1024},"blacklist":{"items":{"anyOf":[{"format":"ipv4","type":"string","title":"IPv4"},{"pattern":"^([0-9]|[1-9][0-9]|1[0-9]{2}|2[0-4][0-9]|25[0-5])\\.([0-9]|[1-9][0-9]|1[0-9]{2}|2[0-4][0-9]|25[0-5])\\.([0-9]|[1-9][0-9]|1[0-9]{2}|2[0-4][0-9]|25[0-5])\\.([0-9]|[1-9][0-9]|1[0-9]{2}|2[0-4][0-9]|25[0-5])/([12]?[0-9]|3[0-2])$","type":"string","title":"IPv4/CIDR"},{"format":"ipv6","type":"string","title":"IPv6"},{"pattern":"^([a-fA-F0-9]{0,4}:){1,8}(:[a-fA-F0-9]{0,4}){0,8}([a-fA-F0-9]{0,4})?/[0-9]{1,3}$","type":"string","title":"IPv6/CIDR"}]},"type":"array","minItems":1},"_meta":{"properties":{"disable":{"type":"boolean"},"priority":{"type":"integer","description":"priority of plugins by customized order"},"filter":{"type":"array","description":"filter determines whether the plugin needs to be executed at runtime"},"error_response":{"oneOf":[{"type":"string"},{"type":"object"}]}},"type":"object"},"whitelist":{"items":{"anyOf":[{"format":"ipv4","type":"string","title":"IPv4"},{"pattern":"^([0-9]|[1-9][0-9]|1[0-9]{2}|2[0-4][0-9]|25[0-5])\\.([0-9]|[1-9][0-9]|1[0-9]{2}|2[0-4][0-9]|25[0-5])\\.([0-9]|[1-9][0-9]|1[0-9]{2}|2[0-4][0-9]|25[0-5])\\.([0-9]|[1-9][0-9]|1[0-9]{2}|2[0-4][0-9]|25[0-5])/([12]?[0-9]|3[0-2])$","type":"string","title":"IPv4/CIDR"},{"format":"ipv6","type":"string","title":"IPv6"},{"pattern":"^([a-fA-F0-9]{0,4}:){1,8}(:[a-fA-F0-9]{0,4}){0,8}([a-fA-F0-9]{0,4})?/[0-9]{1,3}$","type":"string","title":"IPv6/CIDR"}]},"type":"array","minItems":1}}},"priority":3000,"version":0.1},"referer-restriction":{"schema":{"oneOf":[{"required":["whitelist"]},{"required":["blacklist"]}],"type":"object","$comment":"this is a mark for our injected plugin schema","properties":{"bypass_missing":{"default":false,"type":"boolean"},"whitelist":{"items":{"pattern":"^\\*?[0-9a-zA-Z-._\\[\\]:]+$","type":"string"},"type":"array","minItems":1},"blacklist":{"items":{"pattern":"^\\*?[0-9a-zA-Z-._\\[\\]:]+$","type":"string"},"type":"array","minItems":1},"_meta":{"properties":{"disable":{"type":"boolean"},"priority":{"type":"integer","description":"priority of plugins by customized order"},"filter":{"type":"array","description":"filter determines whether the plugin needs to be executed at runtime"},"error_response":{"oneOf":[{"type":"string"},{"type":"object"}]}},"type":"object"},"message":{"default":"Your referer host is not allowed","type":"string","minLength":1,"maxLength":1024}}},"priority":2990,"version":0.1},"redirect":{"schema":{"oneOf":[{"required":["uri"]},{"required":["regex_uri"]},{"required":["http_to_https"]}],"type":"object","$comment":"this is a mark for our injected plugin schema","properties":{"ret_code":{"type":"integer","minimum":200,"default":302},"regex_uri":{"items":{"type":"string","description":"regex uri"},"minItems":2,"description":"params for generating new uri that substitute from client uri, first param is regular expression, the second one is uri template","maxItems":2,"type":"array"},"uri":{"pattern":"(\\\\\\$[0-9a-zA-Z_]+)|\\$\\{([0-9a-zA-Z_]+)\\}|\\$([0-9a-zA-Z_]+)|(\\$|[^$\\\\]+)","type":"string","minLength":2},"_meta":{"properties":{"disable":{"type":"boolean"},"priority":{"type":"integer","description":"priority of plugins by customized order"},"filter":{"type":"array","description":"filter determines whether the plugin needs to be executed at runtime"},"error_response":{"oneOf":[{"type":"string"},{"type":"object"}]}},"type":"object"},"http_to_https":{"type":"boolean"},"encode_uri":{"default":false,"type":"boolean"},"append_query_string":{"default":false,"type":"boolean"}}},"priority":900,"version":0.1},"proxy-rewrite":{"schema":{"$comment":"this is a mark for our injected plugin schema","type":"object","minProperties":1,"properties":{"method":{"type":"string","enum":["POST","PUT","DELETE","MKCOL","COPY","MOVE","OPTIONS","PROPFIND","LOCK","UNLOCK","PATCH","TRACE","GET","HEAD"],"description":"proxy route method"},"regex_uri":{"items":{"type":"string","description":"regex uri"},"type":"array","minItems":2,"description":"new uri that substitute from client uri for upstream, lower priority than uri property"},"uri":{"pattern":"^\\/.*","description":"new uri for upstream","type":"string","minLength":1,"maxLength":4096},"host":{"pattern":"^[0-9a-zA-Z-.]+(:\\d{1,5})?$","type":"string","description":"new host for upstream"},"use_real_request_uri_unsafe":{"type":"boolean","default":false,"description":"use real_request_uri instead, THIS IS VERY UNSAFE."},"_meta":{"properties":{"disable":{"type":"boolean"},"priority":{"type":"integer","description":"priority of plugins by customized order"},"filter":{"type":"array","description":"filter determines whether the plugin needs to be executed at runtime"},"error_response":{"oneOf":[{"type":"string"},{"type":"object"}]}},"type":"object"},"headers":{"oneOf":[{"properties":{"add":{"type":"object","patternProperties":{"^[^:]+$":{"oneOf":[{"type":"string"},{"type":"number"}]}},"minProperties":1},"remove":{"items":{"pattern":"^[^:]+$","type":"string"},"type":"array","minItems":1},"set":{"type":"object","patternProperties":{"^[^:]+$":{"oneOf":[{"type":"string"},{"type":"number"}]}},"minProperties":1}},"type":"object","additionalProperties":false,"minProperties":1},{"type":"object","patternProperties":{"^[^:]+$":{"oneOf":[{"type":"string"},{"type":"number"}]}},"minProperties":1}],"description":"new headers for request"}}},"priority":1008,"version":0.1},"consumer-restriction":{"schema":{"$comment":"this is a mark for our injected plugin schema","type":"object","anyOf":[{"required":["blacklist"]},{"required":["whitelist"]},{"required":["allowed_by_methods"]}],"properties":{"rejected_code":{"type":"integer","minimum":200,"default":403},"rejected_msg":{"type":"string"},"type":{"enum":["consumer_name","service_id","route_id","consumer_group_id"],"default":"consumer_name","type":"string"},"whitelist":{"items":{"type":"string"},"type":"array","minItems":1},"blacklist":{"items":{"type":"string"},"type":"array","minItems":1},"_meta":{"properties":{"disable":{"type":"boolean"},"priority":{"type":"integer","description":"priority of plugins by customized order"},"filter":{"type":"array","description":"filter determines whether the plugin needs to be executed at runtime"},"error_response":{"oneOf":[{"type":"string"},{"type":"object"}]}},"type":"object"},"allowed_by_methods":{"items":{"properties":{"user":{"type":"string"},"methods":{"items":{"type":"string","enum":["GET","POST","PUT","DELETE","PATCH","HEAD","OPTIONS","CONNECT","TRACE","PURGE"],"description":"HTTP method"},"type":"array","minItems":1}},"type":"object"},"type":"array"}}},"priority":2400,"version":0.1},"proxy-mirror":{"schema":{"$comment":"this is a mark for our injected plugin schema","type":"object","required":["host"],"properties":{"host":{"pattern":"^(http(s)?|grpc(s)?):\\/\\/([\\da-zA-Z.-]+|\\[[\\da-fA-F:]+\\])(:\\d+)?$","type":"string"},"path_concat_mode":{"enum":["replace","prefix"],"type":"string","default":"replace","description":"the concatenation mode for custom path"},"sample_ratio":{"default":1,"type":"number","minimum":1e-05,"maximum":1},"_meta":{"properties":{"disable":{"type":"boolean"},"priority":{"type":"integer","description":"priority of plugins by customized order"},"filter":{"type":"array","description":"filter determines whether the plugin needs to be executed at runtime"},"error_response":{"oneOf":[{"type":"string"},{"type":"object"}]}},"type":"object"},"path":{"pattern":"^/[^?&]+$","type":"string"}}},"priority":1010,"version":0.1},"api-breaker":{"schema":{"$comment":"this is a mark for our injected plugin schema","type":"object","required":["break_response_code"],"properties":{"max_breaker_sec":{"type":"integer","minimum":3,"default":300},"_meta":{"properties":{"disable":{"type":"boolean"},"priority":{"type":"integer","description":"priority of plugins by customized order"},"filter":{"type":"array","description":"filter determines whether the plugin needs to be executed at runtime"},"error_response":{"oneOf":[{"type":"string"},{"type":"object"}]}},"type":"object"},"healthy":{"type":"object","default":{"http_statuses":[200],"successes":3},"properties":{"http_statuses":{"items":{"type":"integer","minimum":200,"maximum":499},"minItems":1,"type":"array","uniqueItems":true,"default":[200]},"successes":{"type":"integer","minimum":1,"default":3}}},"unhealthy":{"type":"object","default":{"http_statuses":[500],"failures":3},"properties":{"http_statuses":{"items":{"type":"integer","minimum":500,"maximum":599},"minItems":1,"type":"array","uniqueItems":true,"default":[500]},"failures":{"type":"integer","minimum":1,"default":3}}},"break_response_code":{"type":"integer","minimum":200,"maximum":599},"break_response_body":{"type":"string"},"break_response_headers":{"items":{"type":"object","required":["key","value"],"properties":{"value":{"minLength":1,"type":"string"},"key":{"minLength":1,"type":"string"}}},"type":"array"}}},"priority":1005,"version":0.1},"cors":{"priority":4000,"metadata_schema":{"properties":{"allow_origins":{"additionalProperties":{"pattern":"^(\\*|\\*\\*|null|\\w+://[^,]+(,\\w+://[^,]+)*)$","type":"string"},"type":"object"}},"type":"object"},"schema":{"$comment":"this is a mark for our injected plugin schema","type":"object","properties":{"expose_headers":{"type":"string","default":"*","description":"you can use '*' to expose all header when no credentials,'**' to allow forcefully(it will bring some security risks, be carefully),multiple header use ',' to split. default: *."},"max_age":{"type":"integer","default":5,"description":"maximum number of seconds the results can be cached.-1 means no cached, the max value is depend on browser,more details plz check MDN. default: 5."},"allow_credential":{"type":"boolean","default":false,"description":"allow client append credential. according to CORS specification,if you set this option to 'true', you can not use '*' for other options."},"allow_origins":{"pattern":"^(\\*|\\*\\*|null|\\w+://[^,]+(,\\w+://[^,]+)*)$","type":"string","default":"*","description":"you can use '*' to allow all origins when no credentials,'**' to allow forcefully(it will bring some security risks, be carefully),multiple origin use ',' to split. default: *."},"timing_allow_origins":{"pattern":"^(\\*|\\*\\*|null|\\w+://[^,]+(,\\w+://[^,]+)*)$","type":"string","description":"you can use '*' to allow all origins which can view timing information when no credentials,'**' to allow forcefully (it will bring some security risks, be careful),multiple origin use ',' to split. default: nil"},"allow_origins_by_regex":{"items":{"type":"string","minLength":1,"maxLength":4096},"minItems":1,"description":"you can use regex to allow specific origins when no credentials,for example use [.*\\.test.com$] to allow a.test.com and b.test.com","type":"array","uniqueItems":true},"timing_allow_origins_by_regex":{"items":{"type":"string","minLength":1,"maxLength":4096},"minItems":1,"description":"you can use regex to allow specific origins which can view timing information,for example use [.*\\.test.com] to allow a.test.com and b.test.com","type":"array","uniqueItems":true},"allow_methods":{"type":"string","default":"*","description":"you can use '*' to allow all methods when no credentials,'**' to allow forcefully(it will bring some security risks, be carefully),multiple method use ',' to split. default: *."},"allow_origins_by_metadata":{"items":{"type":"string","minLength":1,"maxLength":4096},"minItems":1,"description":"set allowed origins by referencing origins in plugin metadata","type":"array","uniqueItems":true},"_meta":{"properties":{"disable":{"type":"boolean"},"priority":{"type":"integer","description":"priority of plugins by customized order"},"filter":{"type":"array","description":"filter determines whether the plugin needs to be executed at runtime"},"error_response":{"oneOf":[{"type":"string"},{"type":"object"}]}},"type":"object"},"allow_headers":{"type":"string","default":"*","description":"you can use '*' to allow all header when no credentials,'**' to allow forcefully(it will bring some security risks, be carefully),multiple header use ',' to split. default: *."}}},"version":0.1},"zipkin":{"schema":{"$comment":"this is a mark for our injected plugin schema","type":"object","required":["endpoint","sample_ratio"],"properties":{"span_version":{"default":2,"enum":[1,2]},"endpoint":{"type":"string"},"sample_ratio":{"type":"number","minimum":1e-05,"maximum":1},"server_addr":{"pattern":"^[0-9]{1,3}.[0-9]{1,3}.[0-9]{1,3}.[0-9]{1,3}$","type":"string","description":"default is $server_addr, you can specify your external ip address"},"_meta":{"properties":{"disable":{"type":"boolean"},"priority":{"type":"integer","description":"priority of plugins by customized order"},"filter":{"type":"array","description":"filter determines whether the plugin needs to be executed at runtime"},"error_response":{"oneOf":[{"type":"string"},{"type":"object"}]}},"type":"object"},"service_name":{"type":"string","default":"APISIX","description":"service name for zipkin reporter"}}},"priority":12011,"version":0.1},"proxy-cache":{"schema":{"$comment":"this is a mark for our injected plugin schema","type":"object","properties":{"cache_strategy":{"enum":["disk","memory"],"default":"disk","type":"string"},"cache_http_status":{"items":{"maximum":599,"type":"integer","minimum":200,"description":"http response status"},"minItems":1,"type":"array","uniqueItems":true,"default":[200,301,404]},"cache_method":{"items":{"type":"string","enum":["GET","POST","HEAD"],"description":"supported http method"},"minItems":1,"type":"array","uniqueItems":true,"default":["GET","HEAD"]},"hide_cache_headers":{"default":false,"type":"boolean"},"cache_control":{"default":false,"type":"boolean"},"cache_bypass":{"items":{"pattern":"(^[^\\$].+$|^\\$[0-9a-zA-Z_]+$)","type":"string"},"type":"array","minItems":1},"no_cache":{"items":{"pattern":"(^[^\\$].+$|^\\$[0-9a-zA-Z_]+$)","type":"string"},"type":"array","minItems":1},"cache_ttl":{"type":"integer","minimum":1,"default":300},"cache_key":{"items":{"pattern":"(^[^\\$].+$|^\\$[0-9a-zA-Z_]+$)","type":"string","description":"a key for caching"},"type":"array","minItems":1,"default":["$host","$request_uri"]},"_meta":{"properties":{"disable":{"type":"boolean"},"priority":{"type":"integer","description":"priority of plugins by customized order"},"filter":{"type":"array","description":"filter determines whether the plugin needs to be executed at runtime"},"error_response":{"oneOf":[{"type":"string"},{"type":"object"}]}},"type":"object"},"cache_zone":{"default":"disk_cache_one","type":"string","minLength":1,"maxLength":100}}},"priority":1085,"version":0.2},"serverless-post-function":{"schema":{"$comment":"this is a mark for our injected plugin schema","type":"object","required":["functions"],"properties":{"_meta":{"properties":{"disable":{"type":"boolean"},"priority":{"type":"integer","description":"priority of plugins by customized order"},"filter":{"type":"array","description":"filter determines whether the plugin needs to be executed at runtime"},"error_response":{"oneOf":[{"type":"string"},{"type":"object"}]}},"type":"object"},"phase":{"type":"string","default":"access","enum":["rewrite","access","header_filter","body_filter","log","before_proxy"]},"functions":{"items":{"type":"string"},"type":"array","minItems":1}}},"priority":-2000,"version":0.1},"fault-injection":{"schema":{"$comment":"this is a mark for our injected plugin schema","type":"object","minProperties":1,"properties":{"_meta":{"properties":{"disable":{"type":"boolean"},"priority":{"type":"integer","description":"priority of plugins by customized order"},"filter":{"type":"array","description":"filter determines whether the plugin needs to be executed at runtime"},"error_response":{"oneOf":[{"type":"string"},{"type":"object"}]}},"type":"object"},"delay":{"type":"object","required":["duration"],"properties":{"duration":{"minimum":0,"type":"number"},"vars":{"maxItems":20,"type":"array","items":{"type":"array"}},"percentage":{"type":"integer","minimum":0,"maximum":100}}},"abort":{"type":"object","required":["http_status"],"properties":{"http_status":{"minimum":200,"type":"integer"},"body":{"minLength":0,"type":"string"},"vars":{"maxItems":20,"type":"array","items":{"type":"array"}},"percentage":{"type":"integer","minimum":0,"maximum":100},"headers":{"type":"object","patternProperties":{"^[^:]+$":{"oneOf":[{"type":"string"},{"type":"number"}]}},"minProperties":1}}}}},"priority":11000,"version":0.1},"server-info":{"scope":"global","schema":{"$comment":"this is a mark for our injected plugin schema","type":"object","properties":{"_meta":{"properties":{"disable":{"type":"boolean"},"priority":{"type":"integer","description":"priority of plugins by customized order"},"filter":{"type":"array","description":"filter determines whether the plugin needs to be executed at runtime"},"error_response":{"oneOf":[{"type":"string"},{"type":"object"}]}},"type":"object"}}},"priority":990,"version":0.1},"traffic-split":{"schema":{"$comment":"this is a mark for our injected plugin schema","type":"object","properties":{"_meta":{"properties":{"disable":{"type":"boolean"},"priority":{"type":"integer","description":"priority of plugins by customized order"},"filter":{"type":"array","description":"filter determines whether the plugin needs to be executed at runtime"},"error_response":{"oneOf":[{"type":"string"},{"type":"object"}]}},"type":"object"},"rules":{"items":{"properties":{"weighted_upstreams":{"items":{"properties":{"upstream":{"oneOf":[{"required":["nodes"]},{"required":["service_name","discovery_type"]}],"type":"object","additionalProperties":false,"properties":{"discovery_type":{"type":"string","description":"discovery type"},"discovery_args":{"properties":{"namespace_id":{"type":"string","description":"namespace id"},"group_name":{"type":"string","description":"group name"}},"type":"object"},"create_time":{"type":"integer"},"retries":{"minimum":0,"type":"integer"},"labels":{"type":"object","patternProperties":{".*":{"pattern":"^\\S+$","description":"value of label","type":"string","minLength":1,"maxLength":256}},"description":"key/value pairs to specify attributes"},"nodes":{"anyOf":[{"patternProperties":{".*":{"type":"integer","minimum":0,"description":"weight of node"}},"type":"object"},{"items":{"type":"object","required":["host","weight"],"properties":{"host":{"pattern":"^\\*?[0-9a-zA-Z-._\\[\\]:]+$","type":"string"},"priority":{"type":"integer","default":0,"description":"priority of node"},"weight":{"type":"integer","minimum":0,"description":"weight of node"},"metadata":{"type":"object","description":"metadata of node"},"port":{"type":"integer","minimum":1,"description":"port of node"}}},"type":"array"}]},"id":{"anyOf":[{"pattern":"^[a-zA-Z0-9-_.]+$","type":"string","minLength":1,"maxLength":64},{"minimum":1,"type":"integer"}]},"service_name":{"type":"string","minLength":1,"maxLength":256},"keepalive_pool":{"properties":{"idle_timeout":{"type":"number","default":60,"minimum":0},"requests":{"type":"integer","default":1000,"minimum":1},"size":{"type":"integer","default":320,"minimum":1}},"type":"object"},"update_time":{"type":"integer"},"desc":{"maxLength":256,"type":"string"},"timeout":{"type":"object","required":["connect","send","read"],"properties":{"send":{"exclusiveMinimum":0,"type":"number"},"read":{"exclusiveMinimum":0,"type":"number"},"connect":{"exclusiveMinimum":0,"type":"number"}}},"checks":{"additionalProperties":false,"type":"object","anyOf":[{"required":["active"]},{"required":["active","passive"]}],"properties":{"active":{"properties":{"host":{"pattern":"^\\*?[0-9a-zA-Z-._\\[\\]:]+$","type":"string"},"req_headers":{"items":{"uniqueItems":true,"type":"string"},"type":"array","minItems":1},"timeout":{"default":1,"type":"number"},"port":{"type":"integer","minimum":1,"maximum":65535},"concurrency":{"default":10,"type":"integer"},"healthy":{"properties":{"interval":{"type":"integer","minimum":1,"default":1},"successes":{"default":2,"type":"integer","minimum":1,"maximum":254},"http_statuses":{"items":{"type":"integer","minimum":200,"maximum":599},"minItems":1,"type":"array","uniqueItems":true,"default":[200,302]}},"type":"object"},"https_verify_certificate":{"default":true,"type":"boolean"},"unhealthy":{"properties":{"interval":{"type":"integer","minimum":1,"default":1},"http_statuses":{"items":{"type":"integer","minimum":200,"maximum":599},"minItems":1,"type":"array","uniqueItems":true,"default":[429,404,500,501,502,503,504,505]},"timeouts":{"default":3,"type":"integer","minimum":1,"maximum":254},"http_failures":{"default":5,"type":"integer","minimum":1,"maximum":254},"tcp_failures":{"default":2,"type":"integer","minimum":1,"maximum":254}},"type":"object"},"type":{"enum":["http","https","tcp"],"default":"http","type":"string"},"http_path":{"default":"/","type":"string"}},"type":"object"},"passive":{"properties":{"unhealthy":{"properties":{"timeouts":{"default":7,"type":"integer","minimum":0,"maximum":254},"http_failures":{"default":5,"type":"integer","minimum":0,"maximum":254},"http_statuses":{"items":{"type":"integer","minimum":200,"maximum":599},"minItems":1,"type":"array","uniqueItems":true,"default":[429,500,503]},"tcp_failures":{"default":2,"type":"integer","minimum":0,"maximum":254}},"type":"object"},"type":{"enum":["http","https","tcp"],"default":"http","type":"string"},"healthy":{"properties":{"http_statuses":{"items":{"type":"integer","minimum":200,"maximum":599},"minItems":1,"type":"array","uniqueItems":true,"default":[200,201,202,203,204,205,206,207,208,226,300,301,302,303,304,305,306,307,308]},"successes":{"default":5,"type":"integer","minimum":0,"maximum":254}},"type":"object"}},"type":"object"}}},"key":{"type":"string","description":"the key of chash for dynamic load balancing"},"scheme":{"enum":["grpc","grpcs","http","https","tcp","tls","udp","kafka"],"default":"http","description":"The scheme of the upstream. For L7 proxy, it can be one of grpc/grpcs/http/https. For L4 proxy, it can be one of tcp/tls/udp. For specific protocols, it can be kafka."},"name":{"type":"string","minLength":1,"maxLength":100},"type":{"type":"string","default":"roundrobin","description":"algorithms of load balancing"},"retry_timeout":{"minimum":0,"type":"number"},"hash_on":{"type":"string","default":"vars","enum":["vars","header","cookie","consumer","vars_combinations"]},"tls":{"dependencies":{"client_cert":{"required":["client_key"]},"client_key":{"required":["client_cert"]},"client_cert_id":{"not":{"required":["client_cert","client_key"]}}},"type":"object","properties":{"client_cert":{"type":"string","minLength":128,"maxLength":65536},"verify":{"type":"boolean","default":false,"description":"Turn on server certificate verification, currently only kafka upstream is supported"},"client_cert_id":{"anyOf":[{"pattern":"^[a-zA-Z0-9-_.]+$","type":"string","minLength":1,"maxLength":64},{"minimum":1,"type":"integer"}]},"client_key":{"type":"string","minLength":128,"maxLength":65536}}},"pass_host":{"enum":["pass","node","rewrite"],"type":"string","default":"pass","description":"mod of host passing"},"upstream_host":{"pattern":"^\\*?[0-9a-zA-Z-._\\[\\]:]+$","type":"string"}}},"weight":{"minimum":0,"type":"integer","default":1,"description":"used to split traffic between differentupstreams for plugin configuration"},"upstream_id":{"anyOf":[{"pattern":"^[a-zA-Z0-9-_.]+$","type":"string","minLength":1,"maxLength":64},{"minimum":1,"type":"integer"}]}},"type":"object"},"default":[{"weight":1}],"maxItems":20,"type":"array","minItems":1},"match":{"items":{"properties":{"vars":{"type":"array"}},"type":"object"},"type":"array"}},"type":"object"},"type":"array"}}},"priority":966,"version":0.1},"loki-logger":{"metadata_schema":{"properties":{"log_format":{"type":"object"}},"type":"object"},"schema":{"$comment":"this is a mark for our injected plugin schema","type":"object","required":["endpoint_addrs"],"properties":{"include_req_body":{"default":false,"type":"boolean"},"retry_delay":{"type":"integer","minimum":0,"default":1},"include_req_body_expr":{"items":{"type":"array"},"type":"array","minItems":1},"log_format":{"type":"object"},"batch_max_size":{"type":"integer","minimum":1,"default":1000},"ssl_verify":{"default":false,"type":"boolean"},"tenant_id":{"default":"fake","type":"string"},"keepalive_timeout":{"default":60000,"type":"integer","minimum":1000,"description":"keepalive timeout in milliseconds"},"keepalive_pool":{"type":"integer","minimum":1,"default":5},"buffer_duration":{"type":"integer","minimum":1,"default":60},"include_resp_body_expr":{"items":{"type":"array"},"type":"array","minItems":1},"endpoint_uri":{"type":"string","minLength":1,"default":"/loki/api/v1/push"},"max_retry_count":{"type":"integer","minimum":0,"default":0},"include_resp_body":{"default":false,"type":"boolean"},"name":{"default":"loki logger","type":"string"},"log_labels":{"type":"object","patternProperties":{".*":{"minLength":1,"type":"string"}},"default":{"job":"apisix"}},"timeout":{"default":3000,"maximum":60000,"type":"integer","minimum":1,"description":"timeout in milliseconds"},"endpoint_addrs":{"items":{"pattern":"^[^\\/]+:\\/\\/([\\da-zA-Z.-]+|\\[[\\da-fA-F:]+\\])(:\\d+)?","type":"string"},"type":"array","minItems":1},"inactive_timeout":{"type":"integer","minimum":1,"default":5},"_meta":{"properties":{"disable":{"type":"boolean"},"priority":{"type":"integer","description":"priority of plugins by customized order"},"filter":{"type":"array","description":"filter determines whether the plugin needs to be executed at runtime"},"error_response":{"oneOf":[{"type":"string"},{"type":"object"}]}},"type":"object"},"keepalive":{"default":true,"type":"boolean"}}},"priority":414,"version":0.1},"uri-blocker":{"schema":{"$comment":"this is a mark for our injected plugin schema","type":"object","required":["block_rules"],"properties":{"rejected_code":{"type":"integer","minimum":200,"default":403},"rejected_msg":{"minLength":1,"type":"string"},"_meta":{"properties":{"disable":{"type":"boolean"},"priority":{"type":"integer","description":"priority of plugins by customized order"},"filter":{"type":"array","description":"filter determines whether the plugin needs to be executed at runtime"},"error_response":{"oneOf":[{"type":"string"},{"type":"object"}]}},"type":"object"},"block_rules":{"items":{"type":"string","minLength":1,"maxLength":4096},"type":"array","uniqueItems":true},"case_insensitive":{"default":false,"type":"boolean"}}},"priority":2900,"version":0.1},"basic-auth":{"consumer_schema":{"title":"work with consumer object","properties":{"password":{"type":"string"},"username":{"type":"string"}},"encrypt_fields":["password"],"type":"object","required":["username","password"]},"priority":2520,"version":0.1,"type":"auth","schema":{"$comment":"this is a mark for our injected plugin schema","type":"object","title":"work with route or service object","properties":{"_meta":{"properties":{"disable":{"type":"boolean"},"priority":{"type":"integer","description":"priority of plugins by customized order"},"filter":{"type":"array","description":"filter determines whether the plugin needs to be executed at runtime"},"error_response":{"oneOf":[{"type":"string"},{"type":"object"}]}},"type":"object"},"hide_credentials":{"default":false,"type":"boolean"}}}},"limit-req":{"schema":{"$comment":"this is a mark for our injected plugin schema","type":"object","required":["rate","burst","key"],"properties":{"rate":{"exclusiveMinimum":0,"type":"number"},"rejected_code":{"default":503,"type":"integer","minimum":200,"maximum":599},"rejected_msg":{"minLength":1,"type":"string"},"allow_degradation":{"default":false,"type":"boolean"},"key":{"type":"string"},"burst":{"minimum":0,"type":"number"},"nodelay":{"default":false,"type":"boolean"},"_meta":{"properties":{"disable":{"type":"boolean"},"priority":{"type":"integer","description":"priority of plugins by customized order"},"filter":{"type":"array","description":"filter determines whether the plugin needs to be executed at runtime"},"error_response":{"oneOf":[{"type":"string"},{"type":"object"}]}},"type":"object"},"key_type":{"enum":["var","var_combination"],"default":"var","type":"string"}}},"priority":1001,"version":0.1},"openid-connect":{"schema":{"properties":{"access_token_expires_leeway":{"type":"integer","default":0,"description":"Expiration leeway in seconds for access token renewal."},"set_id_token_header":{"type":"boolean","default":true,"description":"Whether the ID token should be added in the X-ID-Token header to the request for downstream."},"set_userinfo_header":{"type":"boolean","default":true,"description":"Whether the user info token should be added in the X-Userinfo header to the request for downstream."},"proxy_opts":{"type":"object","properties":{"https_proxy_authorization":{"description":"Basic [base64 username:password].","type":"string"},"http_proxy_authorization":{"description":"Basic [base64 username:password].","type":"string"},"http_proxy":{"description":"HTTP proxy like: http://proxy-server:80.","type":"string"},"https_proxy":{"description":"HTTPS proxy like: http://proxy-server:80.","type":"string"},"no_proxy":{"description":"Comma separated list of hosts that should not be proxied.","type":"string"}},"description":"HTTP proxy server be used to access identity server."},"set_refresh_token_header":{"type":"boolean","default":false,"description":"Whether the refresh token should be added in the X-Refresh-Token header to the request for downstream."},"refresh_session_interval":{"type":"integer","description":"Time interval to refresh user ID token without re-authentication."},"iat_slack":{"type":"integer","default":120,"description":"Tolerance of clock skew in seconds with the iat claim in an ID token."},"authorization_params":{"type":"object","description":"Extra authorization params to the authorize endpoint"},"client_id":{"type":"string"},"client_rsa_private_key_id":{"type":"string","description":"Client RSA private key ID used to compute a signed JWT."},"force_reauthorize":{"type":"boolean","default":false,"description":"Whether to execute the authorization flow when a token has been cached."},"client_jwt_assertion_expires_in":{"type":"integer","default":60,"description":"Life duration of the signed JWT in seconds."},"timeout":{"default":3,"type":"integer","minimum":1,"description":"timeout in seconds"},"renew_access_token_on_expiry":{"type":"boolean","default":true,"description":"Whether to attempt silently renewing the access token."},"jwt_verification_cache_ignore":{"type":"boolean","default":false,"description":"Whether to ignore cached verification and re-verify."},"cache_segment":{"type":"string","description":"Name of a cache segment to differentiate caches."},"introspection_interval":{"type":"integer","default":0,"description":"TTL of the cached and introspected access token in seconds."},"introspection_expiry_claim":{"type":"string","description":"Name of the expiry claim that controls the cached access token TTL."},"_meta":{"properties":{"disable":{"type":"boolean"},"priority":{"type":"integer","description":"priority of plugins by customized order"},"filter":{"type":"array","description":"filter determines whether the plugin needs to be executed at runtime"},"error_response":{"oneOf":[{"type":"string"},{"type":"object"}]}},"type":"object"},"required_scopes":{"items":{"type":"string"},"type":"array","description":"List of scopes that are required to be granted to the access token"},"session":{"additionalProperties":false,"type":"object","required":["secret"],"properties":{"secret":{"type":"string","minLength":16,"description":"the key used for the encrypt and HMAC calculation"}}},"introspection_endpoint":{"type":"string"},"introspection_endpoint_auth_method":{"default":"client_secret_basic","type":"string"},"scope":{"default":"openid","type":"string"},"token_endpoint_auth_method":{"default":"client_secret_basic","type":"string"},"bearer_only":{"default":false,"type":"boolean"},"realm":{"default":"apisix","type":"string"},"logout_path":{"default":"/logout","type":"string"},"ssl_verify":{"default":false,"type":"boolean"},"redirect_uri":{"description":"auto append '.apisix/redirect' to ngx.var.uri if not configured","type":"string"},"jwk_expires_in":{"type":"integer","default":86400,"description":"Expiration time for JWK cache in seconds."},"post_logout_redirect_uri":{"description":"the URI will be redirect when request logout_path","type":"string"},"revoke_tokens_on_logout":{"type":"boolean","default":false,"description":"Notify authorization server a previous token is no longer needed."},"unauth_action":{"enum":["auth","deny","pass"],"type":"string","default":"auth","description":"The action performed when client is not authorized. Use auth to redirect user to identity provider, deny to respond with 401 Unauthorized, and pass to allow the request regardless."},"use_nonce":{"type":"boolean","default":false,"description":"Whether to include nonce parameter in authorization request."},"client_secret":{"type":"string"},"public_key":{"type":"string"},"accept_unsupported_alg":{"type":"boolean","default":true,"description":"Ignore ID token signature to accept unsupported signature algorithm."},"token_signing_alg_values_expected":{"type":"string"},"use_pkce":{"type":"boolean","default":false,"description":"when set to true the PKEC(Proof Key for Code Exchange) will be used."},"accept_none_alg":{"type":"boolean","default":false,"description":"Set to true if the OpenID provider does not sign its ID token."},"set_access_token_header":{"type":"boolean","default":true,"description":"Whether the access token should be added as a header to the request for downstream"},"discovery":{"type":"string"},"client_rsa_private_key":{"type":"string","description":"Client RSA private key used to sign JWT."},"access_token_in_authorization_header":{"type":"boolean","default":false,"description":"Whether the access token should be added in the Authorization header as opposed to the X-Access-Token header."},"access_token_expires_in":{"type":"integer","description":"Lifetime of the access token in seconds if expires_in is not present."}},"encrypt_fields":["client_secret"],"type":"object","$comment":"this is a mark for our injected plugin schema","required":["client_id","client_secret","discovery"]},"priority":2599,"version":0.2},"limit-count":{"schema":{"if":{"properties":{"policy":{"enum":["redis"]}}},"else":{"then":{"required":["redis_cluster_nodes","redis_cluster_name"],"properties":{"redis_cluster_ssl":{"default":false,"type":"boolean"},"redis_cluster_nodes":{"items":{"type":"string","minLength":2,"maxLength":100},"type":"array","minItems":1},"redis_cluster_name":{"type":"string"},"redis_password":{"minLength":0,"type":"string"},"redis_cluster_ssl_verify":{"default":false,"type":"boolean"},"redis_timeout":{"type":"integer","minimum":1,"default":1000}}},"if":{"properties":{"policy":{"enum":["redis-cluster"]}}}},"properties":{"rejected_code":{"default":503,"type":"integer","minimum":200,"maximum":599},"rejected_msg":{"minLength":1,"type":"string"},"allow_degradation":{"default":false,"type":"boolean"},"time_window":{"exclusiveMinimum":0,"type":"integer"},"policy":{"enum":["local","redis","redis-cluster"],"default":"local","type":"string"},"show_limit_quota_header":{"default":true,"type":"boolean"},"group":{"type":"string"},"count":{"exclusiveMinimum":0,"type":"integer"},"key":{"default":"remote_addr","type":"string"},"_meta":{"properties":{"disable":{"type":"boolean"},"priority":{"type":"integer","description":"priority of plugins by customized order"},"filter":{"type":"array","description":"filter determines whether the plugin needs to be executed at runtime"},"error_response":{"oneOf":[{"type":"string"},{"type":"object"}]}},"type":"object"},"key_type":{"enum":["var","var_combination","constant"],"default":"var","type":"string"}},"$comment":"this is a mark for our injected plugin schema","type":"object","then":{"required":["redis_host"],"properties":{"redis_ssl":{"default":false,"type":"boolean"},"redis_ssl_verify":{"default":false,"type":"boolean"},"redis_host":{"minLength":2,"type":"string"},"redis_port":{"type":"integer","minimum":1,"default":6379},"redis_username":{"minLength":1,"type":"string"},"redis_password":{"minLength":0,"type":"string"},"redis_database":{"type":"integer","minimum":0,"default":0},"redis_timeout":{"type":"integer","minimum":1,"default":1000}}},"required":["count","time_window"]},"priority":1002,"version":0.5},"tcp-logger":{"priority":405,"metadata_schema":{"properties":{"log_format":{"type":"object"}},"type":"object"},"schema":{"$comment":"this is a mark for our injected plugin schema","type":"object","required":["host","port"],"properties":{"host":{"type":"string"},"tls_options":{"type":"string"},"include_req_body":{"default":false,"type":"boolean"},"retry_delay":{"type":"integer","minimum":0,"default":1},"timeout":{"type":"integer","minimum":1,"default":1000},"log_format":{"type":"object"},"port":{"minimum":0,"type":"integer"},"batch_max_size":{"type":"integer","minimum":1,"default":1000},"name":{"default":"tcp logger","type":"string"},"max_retry_count":{"type":"integer","minimum":0,"default":0},"buffer_duration":{"type":"integer","minimum":1,"default":60},"inactive_timeout":{"type":"integer","minimum":1,"default":5},"_meta":{"properties":{"disable":{"type":"boolean"},"priority":{"type":"integer","description":"priority of plugins by customized order"},"filter":{"type":"array","description":"filter determines whether the plugin needs to be executed at runtime"},"error_response":{"oneOf":[{"type":"string"},{"type":"object"}]}},"type":"object"},"tls":{"default":false,"type":"boolean"}}},"version":0.1},"hmac-auth":{"consumer_schema":{"title":"work with consumer object","properties":{"encode_uri_params":{"type":"boolean","title":"Whether to escape the uri parameter","default":true},"validate_request_body":{"type":"boolean","title":"A boolean value telling the plugin to enable body validation","default":false},"max_req_body":{"type":"integer","title":"Max request body size","default":524288},"access_key":{"type":"string","minLength":1,"maxLength":256},"algorithm":{"enum":["hmac-sha1","hmac-sha256","hmac-sha512"],"default":"hmac-sha256","type":"string"},"secret_key":{"type":"string","minLength":1,"maxLength":256},"clock_skew":{"default":0,"type":"integer"},"signed_headers":{"items":{"type":"string","minLength":1,"maxLength":50},"type":"array"},"keep_headers":{"type":"boolean","title":"whether to keep the http request header","default":false}},"encrypt_fields":["secret_key"],"type":"object","required":["access_key","secret_key"]},"priority":2530,"version":0.1,"type":"auth","schema":{"$comment":"this is a mark for our injected plugin schema","type":"object","title":"work with route or service object","properties":{"_meta":{"properties":{"disable":{"type":"boolean"},"priority":{"type":"integer","description":"priority of plugins by customized order"},"filter":{"type":"array","description":"filter determines whether the plugin needs to be executed at runtime"},"error_response":{"oneOf":[{"type":"string"},{"type":"object"}]}},"type":"object"}}}},"sls-logger":{"schema":{"properties":{"host":{"type":"string"},"log_format":{"type":"object"},"access_key_secret":{"type":"string"},"include_req_body":{"default":false,"type":"boolean"},"project":{"type":"string"},"logstore":{"type":"string"},"access_key_id":{"type":"string"},"port":{"type":"integer"},"batch_max_size":{"type":"integer","minimum":1,"default":1000},"name":{"default":"sls-logger","type":"string"},"buffer_duration":{"type":"integer","minimum":1,"default":60},"retry_delay":{"type":"integer","minimum":0,"default":1},"max_retry_count":{"type":"integer","minimum":0,"default":0},"inactive_timeout":{"type":"integer","minimum":1,"default":5},"_meta":{"properties":{"disable":{"type":"boolean"},"priority":{"type":"integer","description":"priority of plugins by customized order"},"filter":{"type":"array","description":"filter determines whether the plugin needs to be executed at runtime"},"error_response":{"oneOf":[{"type":"string"},{"type":"object"}]}},"type":"object"},"timeout":{"type":"integer","minimum":1,"default":5000}},"encrypt_fields":["access_key_secret"],"type":"object","$comment":"this is a mark for our injected plugin schema","required":["host","port","project","logstore","access_key_id","access_key_secret"]},"priority":406,"version":0.1},"request-id":{"schema":{"$comment":"this is a mark for our injected plugin schema","type":"object","properties":{"_meta":{"properties":{"disable":{"type":"boolean"},"priority":{"type":"integer","description":"priority of plugins by customized order"},"filter":{"type":"array","description":"filter determines whether the plugin needs to be executed at runtime"},"error_response":{"oneOf":[{"type":"string"},{"type":"object"}]}},"type":"object"},"algorithm":{"enum":["uuid","nanoid","range_id"],"default":"uuid","type":"string"},"header_name":{"default":"X-Request-Id","type":"string"},"include_in_response":{"default":true,"type":"boolean"},"range_id":{"type":"object","default":{},"properties":{"char_set":{"type":"string","minLength":6,"default":"abcdefghijklmnopqrstuvwxyzABCDEFGHIGKLMNOPQRSTUVWXYZ0123456789"},"length":{"type":"integer","minimum":6,"default":16}}}}},"priority":12015,"version":0.1},"request-validation":{"priority":2800,"type":"validation","schema":{"$comment":"this is a mark for our injected plugin schema","type":"object","anyOf":[{"required":["header_schema"]},{"required":["body_schema"]}],"properties":{"header_schema":{"type":"object"},"body_schema":{"type":"object"},"rejected_msg":{"type":"string","minLength":1,"maxLength":256},"_meta":{"properties":{"disable":{"type":"boolean"},"priority":{"type":"integer","description":"priority of plugins by customized order"},"filter":{"type":"array","description":"filter determines whether the plugin needs to be executed at runtime"},"error_response":{"oneOf":[{"type":"string"},{"type":"object"}]}},"type":"object"},"rejected_code":{"default":400,"type":"integer","minimum":200,"maximum":599}}},"version":0.1},"kafka-logger":{"metadata_schema":{"properties":{"log_format":{"type":"object"}},"type":"object"},"schema":{"oneOf":[{"required":["broker_list","kafka_topic"]},{"required":["brokers","kafka_topic"]}],"type":"object","$comment":"this is a mark for our injected plugin schema","properties":{"include_req_body":{"default":false,"type":"boolean"},"retry_delay":{"type":"integer","minimum":0,"default":1},"include_req_body_expr":{"items":{"type":"array"},"type":"array","minItems":1},"log_format":{"type":"object"},"batch_max_size":{"type":"integer","minimum":1,"default":1000},"_meta":{"properties":{"disable":{"type":"boolean"},"priority":{"type":"integer","description":"priority of plugins by customized order"},"filter":{"type":"array","description":"filter determines whether the plugin needs to be executed at runtime"},"error_response":{"oneOf":[{"type":"string"},{"type":"object"}]}},"type":"object"},"brokers":{"items":{"type":"object","required":["host","port"],"properties":{"host":{"description":"the host of kafka broker","type":"string"},"sasl_config":{"required":["user","password"],"type":"object","properties":{"mechanism":{"type":"string","default":"PLAIN","enum":["PLAIN"]},"user":{"description":"user","type":"string"},"password":{"description":"password","type":"string"}},"description":"sasl config"},"port":{"description":"the port of kafka broker","type":"integer","minimum":1,"maximum":65535}}},"type":"array","minItems":1,"uniqueItems":true},"inactive_timeout":{"type":"integer","minimum":1,"default":5},"buffer_duration":{"type":"integer","minimum":1,"default":60},"max_retry_count":{"type":"integer","minimum":0,"default":0},"name":{"default":"kafka logger","type":"string"},"meta_format":{"type":"string","default":"default","enum":["default","origin"]},"broker_list":{"type":"object","patternProperties":{".*":{"maximum":65535,"type":"integer","minimum":1,"description":"the port of kafka broker"}},"minProperties":1},"required_acks":{"type":"integer","default":1,"enum":[1,-1]},"timeout":{"type":"integer","minimum":1,"default":3},"include_resp_body_expr":{"items":{"type":"array"},"type":"array","minItems":1},"producer_type":{"type":"string","default":"async","enum":["async","sync"]},"key":{"type":"string"},"include_resp_body":{"default":false,"type":"boolean"},"cluster_name":{"type":"integer","minimum":1,"default":1},"producer_batch_num":{"type":"integer","minimum":1,"default":200},"producer_batch_size":{"type":"integer","minimum":0,"default":1048576},"producer_max_buffering":{"type":"integer","minimum":1,"default":50000},"producer_time_linger":{"type":"integer","minimum":1,"default":1},"meta_refresh_interval":{"type":"integer","minimum":1,"default":30},"kafka_topic":{"type":"string"}}},"priority":403,"version":0.1},"echo":{"schema":{"anyOf":[{"required":["before_body"]},{"required":["body"]},{"required":["after_body"]}],"properties":{"before_body":{"type":"string","description":"body before the filter phase."},"body":{"type":"string","description":"body to replace upstream response."},"after_body":{"type":"string","description":"body after the modification of filter phase."},"_meta":{"properties":{"disable":{"type":"boolean"},"priority":{"type":"integer","description":"priority of plugins by customized order"},"filter":{"type":"array","description":"filter determines whether the plugin needs to be executed at runtime"},"error_response":{"oneOf":[{"type":"string"},{"type":"object"}]}},"type":"object"},"headers":{"type":"object","minProperties":1,"description":"new headers for response"}},"$comment":"this is a mark for our injected plugin schema","type":"object","minProperties":1},"priority":412,"version":0.1},"batch-requests":{"scope":"global","schema":{"$comment":"this is a mark for our injected plugin schema","type":"object","properties":{"_meta":{"properties":{"disable":{"type":"boolean"},"priority":{"type":"integer","description":"priority of plugins by customized order"},"filter":{"type":"array","description":"filter determines whether the plugin needs to be executed at runtime"},"error_response":{"oneOf":[{"type":"string"},{"type":"object"}]}},"type":"object"}}},"version":0.1,"priority":4010,"metadata_schema":{"properties":{"max_body_size":{"default":1048576,"type":"integer","exclusiveMinimum":0,"description":"max pipeline body size in bytes"}},"type":"object"}}},"main":{"plugins":{"items":{"type":"object","required":["name"],"properties":{"stream":{"type":"boolean"},"additionalProperties":false,"name":{"minLength":1,"type":"string"}}},"type":"array"},"service":{"type":"object","additionalProperties":false,"properties":{"plugins":{"type":"object"},"script":{"type":"string","minLength":10,"maxLength":102400},"update_time":{"type":"integer"},"create_time":{"type":"integer"},"enable_websocket":{"type":"boolean","description":"enable websocket for request"},"name":{"type":"string","minLength":1,"maxLength":100},"hosts":{"items":{"pattern":"^\\*?[0-9a-zA-Z-._\\[\\]:]+$","type":"string"},"type":"array","minItems":1,"uniqueItems":true},"upstream_id":{"anyOf":[{"pattern":"^[a-zA-Z0-9-_.]+$","type":"string","minLength":1,"maxLength":64},{"minimum":1,"type":"integer"}]},"id":{"anyOf":[{"pattern":"^[a-zA-Z0-9-_.]+$","type":"string","minLength":1,"maxLength":64},{"minimum":1,"type":"integer"}]},"desc":{"maxLength":256,"type":"string"},"labels":{"type":"object","patternProperties":{".*":{"pattern":"^\\S+$","description":"value of label","type":"string","minLength":1,"maxLength":256}},"description":"key/value pairs to specify attributes"},"upstream":{"oneOf":[{"required":["nodes"]},{"required":["service_name","discovery_type"]}],"type":"object","additionalProperties":false,"properties":{"discovery_type":{"type":"string","description":"discovery type"},"discovery_args":{"properties":{"namespace_id":{"type":"string","description":"namespace id"},"group_name":{"type":"string","description":"group name"}},"type":"object"},"create_time":{"type":"integer"},"retries":{"minimum":0,"type":"integer"},"labels":{"type":"object","patternProperties":{".*":{"pattern":"^\\S+$","description":"value of label","type":"string","minLength":1,"maxLength":256}},"description":"key/value pairs to specify attributes"},"nodes":{"anyOf":[{"patternProperties":{".*":{"type":"integer","minimum":0,"description":"weight of node"}},"type":"object"},{"items":{"type":"object","required":["host","weight"],"properties":{"host":{"pattern":"^\\*?[0-9a-zA-Z-._\\[\\]:]+$","type":"string"},"priority":{"type":"integer","default":0,"description":"priority of node"},"weight":{"type":"integer","minimum":0,"description":"weight of node"},"metadata":{"type":"object","description":"metadata of node"},"port":{"type":"integer","minimum":1,"description":"port of node"}}},"type":"array"}]},"id":{"anyOf":[{"pattern":"^[a-zA-Z0-9-_.]+$","type":"string","minLength":1,"maxLength":64},{"minimum":1,"type":"integer"}]},"service_name":{"type":"string","minLength":1,"maxLength":256},"keepalive_pool":{"properties":{"idle_timeout":{"type":"number","default":60,"minimum":0},"requests":{"type":"integer","default":1000,"minimum":1},"size":{"type":"integer","default":320,"minimum":1}},"type":"object"},"update_time":{"type":"integer"},"desc":{"maxLength":256,"type":"string"},"timeout":{"type":"object","required":["connect","send","read"],"properties":{"send":{"exclusiveMinimum":0,"type":"number"},"read":{"exclusiveMinimum":0,"type":"number"},"connect":{"exclusiveMinimum":0,"type":"number"}}},"checks":{"additionalProperties":false,"type":"object","anyOf":[{"required":["active"]},{"required":["active","passive"]}],"properties":{"active":{"properties":{"host":{"pattern":"^\\*?[0-9a-zA-Z-._\\[\\]:]+$","type":"string"},"req_headers":{"items":{"uniqueItems":true,"type":"string"},"type":"array","minItems":1},"timeout":{"default":1,"type":"number"},"port":{"type":"integer","minimum":1,"maximum":65535},"concurrency":{"default":10,"type":"integer"},"healthy":{"properties":{"interval":{"type":"integer","minimum":1,"default":1},"successes":{"default":2,"type":"integer","minimum":1,"maximum":254},"http_statuses":{"items":{"type":"integer","minimum":200,"maximum":599},"minItems":1,"type":"array","uniqueItems":true,"default":[200,302]}},"type":"object"},"https_verify_certificate":{"default":true,"type":"boolean"},"unhealthy":{"properties":{"interval":{"type":"integer","minimum":1,"default":1},"http_statuses":{"items":{"type":"integer","minimum":200,"maximum":599},"minItems":1,"type":"array","uniqueItems":true,"default":[429,404,500,501,502,503,504,505]},"timeouts":{"default":3,"type":"integer","minimum":1,"maximum":254},"http_failures":{"default":5,"type":"integer","minimum":1,"maximum":254},"tcp_failures":{"default":2,"type":"integer","minimum":1,"maximum":254}},"type":"object"},"type":{"enum":["http","https","tcp"],"default":"http","type":"string"},"http_path":{"default":"/","type":"string"}},"type":"object"},"passive":{"properties":{"unhealthy":{"properties":{"timeouts":{"default":7,"type":"integer","minimum":0,"maximum":254},"http_failures":{"default":5,"type":"integer","minimum":0,"maximum":254},"http_statuses":{"items":{"type":"integer","minimum":200,"maximum":599},"minItems":1,"type":"array","uniqueItems":true,"default":[429,500,503]},"tcp_failures":{"default":2,"type":"integer","minimum":0,"maximum":254}},"type":"object"},"type":{"enum":["http","https","tcp"],"default":"http","type":"string"},"healthy":{"properties":{"http_statuses":{"items":{"type":"integer","minimum":200,"maximum":599},"minItems":1,"type":"array","uniqueItems":true,"default":[200,201,202,203,204,205,206,207,208,226,300,301,302,303,304,305,306,307,308]},"successes":{"default":5,"type":"integer","minimum":0,"maximum":254}},"type":"object"}},"type":"object"}}},"key":{"type":"string","description":"the key of chash for dynamic load balancing"},"scheme":{"enum":["grpc","grpcs","http","https","tcp","tls","udp","kafka"],"default":"http","description":"The scheme of the upstream. For L7 proxy, it can be one of grpc/grpcs/http/https. For L4 proxy, it can be one of tcp/tls/udp. For specific protocols, it can be kafka."},"name":{"type":"string","minLength":1,"maxLength":100},"type":{"type":"string","default":"roundrobin","description":"algorithms of load balancing"},"retry_timeout":{"minimum":0,"type":"number"},"hash_on":{"type":"string","default":"vars","enum":["vars","header","cookie","consumer","vars_combinations"]},"tls":{"dependencies":{"client_cert":{"required":["client_key"]},"client_key":{"required":["client_cert"]},"client_cert_id":{"not":{"required":["client_cert","client_key"]}}},"type":"object","properties":{"client_cert":{"type":"string","minLength":128,"maxLength":65536},"verify":{"type":"boolean","default":false,"description":"Turn on server certificate verification, currently only kafka upstream is supported"},"client_cert_id":{"anyOf":[{"pattern":"^[a-zA-Z0-9-_.]+$","type":"string","minLength":1,"maxLength":64},{"minimum":1,"type":"integer"}]},"client_key":{"type":"string","minLength":128,"maxLength":65536}}},"pass_host":{"enum":["pass","node","rewrite"],"type":"string","default":"pass","description":"mod of host passing"},"upstream_host":{"pattern":"^\\*?[0-9a-zA-Z-._\\[\\]:]+$","type":"string"}}}}},"consumer":{"additionalProperties":false,"type":"object","required":["username"],"properties":{"plugins":{"type":"object"},"username":{"pattern":"^[a-zA-Z0-9_]+$","type":"string","minLength":1,"maxLength":100},"update_time":{"type":"integer"},"create_time":{"type":"integer"},"group_id":{"anyOf":[{"pattern":"^[a-zA-Z0-9-_.]+$","type":"string","minLength":1,"maxLength":64},{"minimum":1,"type":"integer"}]},"labels":{"type":"object","patternProperties":{".*":{"pattern":"^\\S+$","description":"value of label","type":"string","minLength":1,"maxLength":256}},"description":"key/value pairs to specify attributes"},"desc":{"maxLength":256,"type":"string"}}},"stream_route":{"type":"object","additionalProperties":false,"properties":{"upstream":{"oneOf":[{"required":["nodes"]},{"required":["service_name","discovery_type"]}],"type":"object","additionalProperties":false,"properties":{"discovery_type":{"type":"string","description":"discovery type"},"discovery_args":{"properties":{"namespace_id":{"type":"string","description":"namespace id"},"group_name":{"type":"string","description":"group name"}},"type":"object"},"create_time":{"type":"integer"},"retries":{"minimum":0,"type":"integer"},"labels":{"type":"object","patternProperties":{".*":{"pattern":"^\\S+$","description":"value of label","type":"string","minLength":1,"maxLength":256}},"description":"key/value pairs to specify attributes"},"nodes":{"anyOf":[{"patternProperties":{".*":{"type":"integer","minimum":0,"description":"weight of node"}},"type":"object"},{"items":{"type":"object","required":["host","weight"],"properties":{"host":{"pattern":"^\\*?[0-9a-zA-Z-._\\[\\]:]+$","type":"string"},"priority":{"type":"integer","default":0,"description":"priority of node"},"weight":{"type":"integer","minimum":0,"description":"weight of node"},"metadata":{"type":"object","description":"metadata of node"},"port":{"type":"integer","minimum":1,"description":"port of node"}}},"type":"array"}]},"id":{"anyOf":[{"pattern":"^[a-zA-Z0-9-_.]+$","type":"string","minLength":1,"maxLength":64},{"minimum":1,"type":"integer"}]},"service_name":{"type":"string","minLength":1,"maxLength":256},"keepalive_pool":{"properties":{"idle_timeout":{"type":"number","default":60,"minimum":0},"requests":{"type":"integer","default":1000,"minimum":1},"size":{"type":"integer","default":320,"minimum":1}},"type":"object"},"update_time":{"type":"integer"},"desc":{"maxLength":256,"type":"string"},"timeout":{"type":"object","required":["connect","send","read"],"properties":{"send":{"exclusiveMinimum":0,"type":"number"},"read":{"exclusiveMinimum":0,"type":"number"},"connect":{"exclusiveMinimum":0,"type":"number"}}},"checks":{"additionalProperties":false,"type":"object","anyOf":[{"required":["active"]},{"required":["active","passive"]}],"properties":{"active":{"properties":{"host":{"pattern":"^\\*?[0-9a-zA-Z-._\\[\\]:]+$","type":"string"},"req_headers":{"items":{"uniqueItems":true,"type":"string"},"type":"array","minItems":1},"timeout":{"default":1,"type":"number"},"port":{"type":"integer","minimum":1,"maximum":65535},"concurrency":{"default":10,"type":"integer"},"healthy":{"properties":{"interval":{"type":"integer","minimum":1,"default":1},"successes":{"default":2,"type":"integer","minimum":1,"maximum":254},"http_statuses":{"items":{"type":"integer","minimum":200,"maximum":599},"minItems":1,"type":"array","uniqueItems":true,"default":[200,302]}},"type":"object"},"https_verify_certificate":{"default":true,"type":"boolean"},"unhealthy":{"properties":{"interval":{"type":"integer","minimum":1,"default":1},"http_statuses":{"items":{"type":"integer","minimum":200,"maximum":599},"minItems":1,"type":"array","uniqueItems":true,"default":[429,404,500,501,502,503,504,505]},"timeouts":{"default":3,"type":"integer","minimum":1,"maximum":254},"http_failures":{"default":5,"type":"integer","minimum":1,"maximum":254},"tcp_failures":{"default":2,"type":"integer","minimum":1,"maximum":254}},"type":"object"},"type":{"enum":["http","https","tcp"],"default":"http","type":"string"},"http_path":{"default":"/","type":"string"}},"type":"object"},"passive":{"properties":{"unhealthy":{"properties":{"timeouts":{"default":7,"type":"integer","minimum":0,"maximum":254},"http_failures":{"default":5,"type":"integer","minimum":0,"maximum":254},"http_statuses":{"items":{"type":"integer","minimum":200,"maximum":599},"minItems":1,"type":"array","uniqueItems":true,"default":[429,500,503]},"tcp_failures":{"default":2,"type":"integer","minimum":0,"maximum":254}},"type":"object"},"type":{"enum":["http","https","tcp"],"default":"http","type":"string"},"healthy":{"properties":{"http_statuses":{"items":{"type":"integer","minimum":200,"maximum":599},"minItems":1,"type":"array","uniqueItems":true,"default":[200,201,202,203,204,205,206,207,208,226,300,301,302,303,304,305,306,307,308]},"successes":{"default":5,"type":"integer","minimum":0,"maximum":254}},"type":"object"}},"type":"object"}}},"key":{"type":"string","description":"the key of chash for dynamic load balancing"},"scheme":{"enum":["grpc","grpcs","http","https","tcp","tls","udp","kafka"],"default":"http","description":"The scheme of the upstream. For L7 proxy, it can be one of grpc/grpcs/http/https. For L4 proxy, it can be one of tcp/tls/udp. For specific protocols, it can be kafka."},"name":{"type":"string","minLength":1,"maxLength":100},"type":{"type":"string","default":"roundrobin","description":"algorithms of load balancing"},"retry_timeout":{"minimum":0,"type":"number"},"hash_on":{"type":"string","default":"vars","enum":["vars","header","cookie","consumer","vars_combinations"]},"tls":{"dependencies":{"client_cert":{"required":["client_key"]},"client_key":{"required":["client_cert"]},"client_cert_id":{"not":{"required":["client_cert","client_key"]}}},"type":"object","properties":{"client_cert":{"type":"string","minLength":128,"maxLength":65536},"verify":{"type":"boolean","default":false,"description":"Turn on server certificate verification, currently only kafka upstream is supported"},"client_cert_id":{"anyOf":[{"pattern":"^[a-zA-Z0-9-_.]+$","type":"string","minLength":1,"maxLength":64},{"minimum":1,"type":"integer"}]},"client_key":{"type":"string","minLength":128,"maxLength":65536}}},"pass_host":{"enum":["pass","node","rewrite"],"type":"string","default":"pass","description":"mod of host passing"},"upstream_host":{"pattern":"^\\*?[0-9a-zA-Z-._\\[\\]:]+$","type":"string"}}},"update_time":{"type":"integer"},"protocol":{"type":"object","required":["name"],"properties":{"logger":{"items":{"dependencies":{"name":["conf"]},"additionalProperties":false,"properties":{"filter":{"type":"array","description":"logger filter rules"},"name":{"type":"string"},"conf":{"type":"object","description":"logger plugin configuration"}}},"type":"array"},"name":{"type":"string"},"conf":{"type":"object","description":"protocol-specific configuration"},"superior_id":{"anyOf":[{"pattern":"^[a-zA-Z0-9-_.]+$","type":"string","minLength":1,"maxLength":64},{"minimum":1,"type":"integer"}]}}},"server_addr":{"type":"string","anyOf":[{"format":"ipv4","type":"string","title":"IPv4"},{"pattern":"^([0-9]|[1-9][0-9]|1[0-9]{2}|2[0-4][0-9]|25[0-5])\\.([0-9]|[1-9][0-9]|1[0-9]{2}|2[0-4][0-9]|25[0-5])\\.([0-9]|[1-9][0-9]|1[0-9]{2}|2[0-4][0-9]|25[0-5])\\.([0-9]|[1-9][0-9]|1[0-9]{2}|2[0-4][0-9]|25[0-5])/([12]?[0-9]|3[0-2])$","type":"string","title":"IPv4/CIDR"},{"format":"ipv6","type":"string","title":"IPv6"},{"pattern":"^([a-fA-F0-9]{0,4}:){1,8}(:[a-fA-F0-9]{0,4}){0,8}([a-fA-F0-9]{0,4})?/[0-9]{1,3}$","type":"string","title":"IPv6/CIDR"}],"description":"server IP"},"plugins":{"type":"object"},"service_id":{"anyOf":[{"pattern":"^[a-zA-Z0-9-_.]+$","type":"string","minLength":1,"maxLength":64},{"minimum":1,"type":"integer"}]},"labels":{"type":"object","patternProperties":{".*":{"pattern":"^\\S+$","description":"value of label","type":"string","minLength":1,"maxLength":256}},"description":"key/value pairs to specify attributes"},"sni":{"pattern":"^\\*?[0-9a-zA-Z-._\\[\\]:]+$","type":"string","description":"server name indication"},"id":{"anyOf":[{"pattern":"^[a-zA-Z0-9-_.]+$","type":"string","minLength":1,"maxLength":64},{"minimum":1,"type":"integer"}]},"upstream_id":{"anyOf":[{"pattern":"^[a-zA-Z0-9-_.]+$","type":"string","minLength":1,"maxLength":64},{"minimum":1,"type":"integer"}]},"create_time":{"type":"integer"},"desc":{"maxLength":256,"type":"string"},"server_port":{"type":"integer","description":"server port"},"remote_addr":{"type":"string","anyOf":[{"format":"ipv4","type":"string","title":"IPv4"},{"pattern":"^([0-9]|[1-9][0-9]|1[0-9]{2}|2[0-4][0-9]|25[0-5])\\.([0-9]|[1-9][0-9]|1[0-9]{2}|2[0-4][0-9]|25[0-5])\\.([0-9]|[1-9][0-9]|1[0-9]{2}|2[0-4][0-9]|25[0-5])\\.([0-9]|[1-9][0-9]|1[0-9]{2}|2[0-4][0-9]|25[0-5])/([12]?[0-9]|3[0-2])$","type":"string","title":"IPv4/CIDR"},{"format":"ipv6","type":"string","title":"IPv6"},{"pattern":"^([a-fA-F0-9]{0,4}:){1,8}(:[a-fA-F0-9]{0,4}){0,8}([a-fA-F0-9]{0,4})?/[0-9]{1,3}$","type":"string","title":"IPv6/CIDR"}],"description":"client IP"}}},"upstream_hash_vars_schema":{"pattern":"^((uri|server_name|server_addr|request_uri|remote_port|remote_addr|query_string|host|hostname|mqtt_client_id)|arg_[0-9a-zA-z_-]+)$","type":"string"},"upstream_hash_header_schema":{"pattern":"^[a-zA-Z0-9-_]+$","type":"string"},"plugin_config":{"additionalProperties":false,"type":"object","required":["id","plugins"],"properties":{"plugins":{"type":"object"},"name":{"type":"string"},"update_time":{"type":"integer"},"id":{"anyOf":[{"pattern":"^[a-zA-Z0-9-_.]+$","type":"string","minLength":1,"maxLength":64},{"minimum":1,"type":"integer"}]},"desc":{"maxLength":256,"type":"string"},"labels":{"type":"object","patternProperties":{".*":{"pattern":"^\\S+$","description":"value of label","type":"string","minLength":1,"maxLength":256}},"description":"key/value pairs to specify attributes"},"create_time":{"type":"integer"}}},"consumer_group":{"additionalProperties":false,"type":"object","required":["id","plugins"],"properties":{"plugins":{"type":"object"},"update_time":{"type":"integer"},"id":{"anyOf":[{"pattern":"^[a-zA-Z0-9-_.]+$","type":"string","minLength":1,"maxLength":64},{"minimum":1,"type":"integer"}]},"desc":{"maxLength":256,"type":"string"},"labels":{"type":"object","patternProperties":{".*":{"pattern":"^\\S+$","description":"value of label","type":"string","minLength":1,"maxLength":256}},"description":"key/value pairs to specify attributes"},"create_time":{"type":"integer"}}},"upstream":{"oneOf":[{"required":["nodes"]},{"required":["service_name","discovery_type"]}],"type":"object","additionalProperties":false,"properties":{"discovery_type":{"type":"string","description":"discovery type"},"discovery_args":{"properties":{"namespace_id":{"type":"string","description":"namespace id"},"group_name":{"type":"string","description":"group name"}},"type":"object"},"create_time":{"type":"integer"},"retries":{"minimum":0,"type":"integer"},"labels":{"type":"object","patternProperties":{".*":{"pattern":"^\\S+$","description":"value of label","type":"string","minLength":1,"maxLength":256}},"description":"key/value pairs to specify attributes"},"nodes":{"anyOf":[{"patternProperties":{".*":{"type":"integer","minimum":0,"description":"weight of node"}},"type":"object"},{"items":{"type":"object","required":["host","weight"],"properties":{"host":{"pattern":"^\\*?[0-9a-zA-Z-._\\[\\]:]+$","type":"string"},"priority":{"type":"integer","default":0,"description":"priority of node"},"weight":{"type":"integer","minimum":0,"description":"weight of node"},"metadata":{"type":"object","description":"metadata of node"},"port":{"type":"integer","minimum":1,"description":"port of node"}}},"type":"array"}]},"id":{"anyOf":[{"pattern":"^[a-zA-Z0-9-_.]+$","type":"string","minLength":1,"maxLength":64},{"minimum":1,"type":"integer"}]},"service_name":{"type":"string","minLength":1,"maxLength":256},"keepalive_pool":{"properties":{"idle_timeout":{"type":"number","default":60,"minimum":0},"requests":{"type":"integer","default":1000,"minimum":1},"size":{"type":"integer","default":320,"minimum":1}},"type":"object"},"update_time":{"type":"integer"},"desc":{"maxLength":256,"type":"string"},"timeout":{"type":"object","required":["connect","send","read"],"properties":{"send":{"exclusiveMinimum":0,"type":"number"},"read":{"exclusiveMinimum":0,"type":"number"},"connect":{"exclusiveMinimum":0,"type":"number"}}},"checks":{"additionalProperties":false,"type":"object","anyOf":[{"required":["active"]},{"required":["active","passive"]}],"properties":{"active":{"properties":{"host":{"pattern":"^\\*?[0-9a-zA-Z-._\\[\\]:]+$","type":"string"},"req_headers":{"items":{"uniqueItems":true,"type":"string"},"type":"array","minItems":1},"timeout":{"default":1,"type":"number"},"port":{"type":"integer","minimum":1,"maximum":65535},"concurrency":{"default":10,"type":"integer"},"healthy":{"properties":{"interval":{"type":"integer","minimum":1,"default":1},"successes":{"default":2,"type":"integer","minimum":1,"maximum":254},"http_statuses":{"items":{"type":"integer","minimum":200,"maximum":599},"minItems":1,"type":"array","uniqueItems":true,"default":[200,302]}},"type":"object"},"https_verify_certificate":{"default":true,"type":"boolean"},"unhealthy":{"properties":{"interval":{"type":"integer","minimum":1,"default":1},"http_statuses":{"items":{"type":"integer","minimum":200,"maximum":599},"minItems":1,"type":"array","uniqueItems":true,"default":[429,404,500,501,502,503,504,505]},"timeouts":{"default":3,"type":"integer","minimum":1,"maximum":254},"http_failures":{"default":5,"type":"integer","minimum":1,"maximum":254},"tcp_failures":{"default":2,"type":"integer","minimum":1,"maximum":254}},"type":"object"},"type":{"enum":["http","https","tcp"],"default":"http","type":"string"},"http_path":{"default":"/","type":"string"}},"type":"object"},"passive":{"properties":{"unhealthy":{"properties":{"timeouts":{"default":7,"type":"integer","minimum":0,"maximum":254},"http_failures":{"default":5,"type":"integer","minimum":0,"maximum":254},"http_statuses":{"items":{"type":"integer","minimum":200,"maximum":599},"minItems":1,"type":"array","uniqueItems":true,"default":[429,500,503]},"tcp_failures":{"default":2,"type":"integer","minimum":0,"maximum":254}},"type":"object"},"type":{"enum":["http","https","tcp"],"default":"http","type":"string"},"healthy":{"properties":{"http_statuses":{"items":{"type":"integer","minimum":200,"maximum":599},"minItems":1,"type":"array","uniqueItems":true,"default":[200,201,202,203,204,205,206,207,208,226,300,301,302,303,304,305,306,307,308]},"successes":{"default":5,"type":"integer","minimum":0,"maximum":254}},"type":"object"}},"type":"object"}}},"key":{"type":"string","description":"the key of chash for dynamic load balancing"},"scheme":{"enum":["grpc","grpcs","http","https","tcp","tls","udp","kafka"],"default":"http","description":"The scheme of the upstream. For L7 proxy, it can be one of grpc/grpcs/http/https. For L4 proxy, it can be one of tcp/tls/udp. For specific protocols, it can be kafka."},"name":{"type":"string","minLength":1,"maxLength":100},"type":{"type":"string","default":"roundrobin","description":"algorithms of load balancing"},"retry_timeout":{"minimum":0,"type":"number"},"hash_on":{"type":"string","default":"vars","enum":["vars","header","cookie","consumer","vars_combinations"]},"tls":{"dependencies":{"client_cert":{"required":["client_key"]},"client_key":{"required":["client_cert"]},"client_cert_id":{"not":{"required":["client_cert","client_key"]}}},"type":"object","properties":{"client_cert":{"type":"string","minLength":128,"maxLength":65536},"verify":{"type":"boolean","default":false,"description":"Turn on server certificate verification, currently only kafka upstream is supported"},"client_cert_id":{"anyOf":[{"pattern":"^[a-zA-Z0-9-_.]+$","type":"string","minLength":1,"maxLength":64},{"minimum":1,"type":"integer"}]},"client_key":{"type":"string","minLength":128,"maxLength":65536}}},"pass_host":{"enum":["pass","node","rewrite"],"type":"string","default":"pass","description":"mod of host passing"},"upstream_host":{"pattern":"^\\*?[0-9a-zA-Z-._\\[\\]:]+$","type":"string"}}},"ssl":{"then":{"oneOf":[{"required":["sni","key","cert"]},{"required":["snis","key","cert"]}]},"else":{"required":["key","cert"]},"properties":{"keys":{"items":{"type":"string","minLength":128,"maxLength":65536},"type":"array"},"status":{"enum":[1,0],"type":"integer","default":1,"description":"ssl status, 1 to enable, 0 to disable"},"update_time":{"type":"integer"},"type":{"enum":["server","client"],"type":"string","default":"server","description":"ssl certificate type, server to server certificate, client to client certificate for upstream"},"ssl_protocols":{"items":{"enum":["TLSv1.1","TLSv1.2","TLSv1.3"]},"description":"set ssl protocols","maxItems":3,"type":"array","uniqueItems":true},"snis":{"items":{"pattern":"^\\*?[0-9a-zA-Z-._\\[\\]:]+$","type":"string"},"type":"array","minItems":1},"certs":{"items":{"type":"string","minLength":128,"maxLength":65536},"type":"array"},"sni":{"pattern":"^\\*?[0-9a-zA-Z-._\\[\\]:]+$","type":"string"},"create_time":{"type":"integer"},"key":{"oneOf":[{"type":"string","minLength":128,"maxLength":65536},{"pattern":"^\\$(secret|env)://","type":"string"}]},"id":{"anyOf":[{"pattern":"^[a-zA-Z0-9-_.]+$","type":"string","minLength":1,"maxLength":64},{"minimum":1,"type":"integer"}]},"client":{"type":"object","required":["ca"],"properties":{"depth":{"type":"integer","minimum":0,"default":1},"ca":{"type":"string","minLength":128,"maxLength":65536},"skip_mtls_uri_regex":{"items":{"type":"string","description":"uri regular expression to skip mtls"},"type":"array","minItems":1,"uniqueItems":true}}},"labels":{"type":"object","patternProperties":{".*":{"pattern":"^\\S+$","description":"value of label","type":"string","minLength":1,"maxLength":256}},"description":"key/value pairs to specify attributes"},"cert":{"oneOf":[{"type":"string","minLength":128,"maxLength":65536},{"pattern":"^\\$(secret|env)://","type":"string"}]}},"type":"object","additionalProperties":false,"if":{"properties":{"type":{"enum":["server"]}}}},"global_rule":{"properties":{"id":{"anyOf":[{"pattern":"^[a-zA-Z0-9-_.]+$","type":"string","minLength":1,"maxLength":64},{"minimum":1,"type":"integer"}]},"plugins":{"type":"object"},"create_time":{"type":"integer"},"update_time":{"type":"integer"}},"additionalProperties":false,"required":["id","plugins"],"type":"object"},"route":{"additionalProperties":false,"anyOf":[{"required":["plugins","uri"]},{"required":["upstream","uri"]},{"required":["upstream_id","uri"]},{"required":["service_id","uri"]},{"required":["plugins","uris"]},{"required":["upstream","uris"]},{"required":["upstream_id","uris"]},{"required":["service_id","uris"]},{"required":["script","uri"]},{"required":["script","uris"]}],"allOf":[{"oneOf":[{"required":["uri"]},{"required":["uris"]}]},{"oneOf":[{"not":{"anyOf":[{"required":["host"]},{"required":["hosts"]}]}},{"required":["host"]},{"required":["hosts"]}]},{"oneOf":[{"not":{"anyOf":[{"required":["remote_addr"]},{"required":["remote_addrs"]}]}},{"required":["remote_addr"]},{"required":["remote_addrs"]}]}],"type":"object","not":{"anyOf":[{"required":["script","plugins"]},{"required":["script","plugin_config_id"]}]},"properties":{"plugin_config_id":{"anyOf":[{"pattern":"^[a-zA-Z0-9-_.]+$","type":"string","minLength":1,"maxLength":64},{"minimum":1,"type":"integer"}]},"status":{"enum":[1,0],"type":"integer","default":1,"description":"route status, 1 to enable, 0 to disable"},"service_id":{"anyOf":[{"pattern":"^[a-zA-Z0-9-_.]+$","type":"string","minLength":1,"maxLength":64},{"minimum":1,"type":"integer"}]},"enable_websocket":{"type":"boolean","description":"enable websocket for request"},"uri":{"type":"string","minLength":1,"maxLength":4096},"upstream_id":{"anyOf":[{"pattern":"^[a-zA-Z0-9-_.]+$","type":"string","minLength":1,"maxLength":64},{"minimum":1,"type":"integer"}]},"create_time":{"type":"integer"},"desc":{"maxLength":256,"type":"string"},"labels":{"type":"object","patternProperties":{".*":{"pattern":"^\\S+$","description":"value of label","type":"string","minLength":1,"maxLength":256}},"description":"key/value pairs to specify attributes"},"uris":{"items":{"type":"string","description":"HTTP uri"},"type":"array","minItems":1,"uniqueItems":true},"host":{"pattern":"^\\*?[0-9a-zA-Z-._\\[\\]:]+$","type":"string"},"priority":{"default":0,"type":"integer"},"script":{"type":"string","minLength":10,"maxLength":102400},"update_time":{"type":"integer"},"id":{"anyOf":[{"pattern":"^[a-zA-Z0-9-_.]+$","type":"string","minLength":1,"maxLength":64},{"minimum":1,"type":"integer"}]},"timeout":{"type":"object","required":["connect","send","read"],"properties":{"send":{"exclusiveMinimum":0,"type":"number"},"read":{"exclusiveMinimum":0,"type":"number"},"connect":{"exclusiveMinimum":0,"type":"number"}}},"upstream":{"oneOf":[{"required":["nodes"]},{"required":["service_name","discovery_type"]}],"type":"object","additionalProperties":false,"properties":{"discovery_type":{"type":"string","description":"discovery type"},"discovery_args":{"properties":{"namespace_id":{"type":"string","description":"namespace id"},"group_name":{"type":"string","description":"group name"}},"type":"object"},"create_time":{"type":"integer"},"retries":{"minimum":0,"type":"integer"},"labels":{"type":"object","patternProperties":{".*":{"pattern":"^\\S+$","description":"value of label","type":"string","minLength":1,"maxLength":256}},"description":"key/value pairs to specify attributes"},"nodes":{"anyOf":[{"patternProperties":{".*":{"type":"integer","minimum":0,"description":"weight of node"}},"type":"object"},{"items":{"type":"object","required":["host","weight"],"properties":{"host":{"pattern":"^\\*?[0-9a-zA-Z-._\\[\\]:]+$","type":"string"},"priority":{"type":"integer","default":0,"description":"priority of node"},"weight":{"type":"integer","minimum":0,"description":"weight of node"},"metadata":{"type":"object","description":"metadata of node"},"port":{"type":"integer","minimum":1,"description":"port of node"}}},"type":"array"}]},"id":{"anyOf":[{"pattern":"^[a-zA-Z0-9-_.]+$","type":"string","minLength":1,"maxLength":64},{"minimum":1,"type":"integer"}]},"service_name":{"type":"string","minLength":1,"maxLength":256},"keepalive_pool":{"properties":{"idle_timeout":{"type":"number","default":60,"minimum":0},"requests":{"type":"integer","default":1000,"minimum":1},"size":{"type":"integer","default":320,"minimum":1}},"type":"object"},"update_time":{"type":"integer"},"desc":{"maxLength":256,"type":"string"},"timeout":{"type":"object","required":["connect","send","read"],"properties":{"send":{"exclusiveMinimum":0,"type":"number"},"read":{"exclusiveMinimum":0,"type":"number"},"connect":{"exclusiveMinimum":0,"type":"number"}}},"checks":{"additionalProperties":false,"type":"object","anyOf":[{"required":["active"]},{"required":["active","passive"]}],"properties":{"active":{"properties":{"host":{"pattern":"^\\*?[0-9a-zA-Z-._\\[\\]:]+$","type":"string"},"req_headers":{"items":{"uniqueItems":true,"type":"string"},"type":"array","minItems":1},"timeout":{"default":1,"type":"number"},"port":{"type":"integer","minimum":1,"maximum":65535},"concurrency":{"default":10,"type":"integer"},"healthy":{"properties":{"interval":{"type":"integer","minimum":1,"default":1},"successes":{"default":2,"type":"integer","minimum":1,"maximum":254},"http_statuses":{"items":{"type":"integer","minimum":200,"maximum":599},"minItems":1,"type":"array","uniqueItems":true,"default":[200,302]}},"type":"object"},"https_verify_certificate":{"default":true,"type":"boolean"},"unhealthy":{"properties":{"interval":{"type":"integer","minimum":1,"default":1},"http_statuses":{"items":{"type":"integer","minimum":200,"maximum":599},"minItems":1,"type":"array","uniqueItems":true,"default":[429,404,500,501,502,503,504,505]},"timeouts":{"default":3,"type":"integer","minimum":1,"maximum":254},"http_failures":{"default":5,"type":"integer","minimum":1,"maximum":254},"tcp_failures":{"default":2,"type":"integer","minimum":1,"maximum":254}},"type":"object"},"type":{"enum":["http","https","tcp"],"default":"http","type":"string"},"http_path":{"default":"/","type":"string"}},"type":"object"},"passive":{"properties":{"unhealthy":{"properties":{"timeouts":{"default":7,"type":"integer","minimum":0,"maximum":254},"http_failures":{"default":5,"type":"integer","minimum":0,"maximum":254},"http_statuses":{"items":{"type":"integer","minimum":200,"maximum":599},"minItems":1,"type":"array","uniqueItems":true,"default":[429,500,503]},"tcp_failures":{"default":2,"type":"integer","minimum":0,"maximum":254}},"type":"object"},"type":{"enum":["http","https","tcp"],"default":"http","type":"string"},"healthy":{"properties":{"http_statuses":{"items":{"type":"integer","minimum":200,"maximum":599},"minItems":1,"type":"array","uniqueItems":true,"default":[200,201,202,203,204,205,206,207,208,226,300,301,302,303,304,305,306,307,308]},"successes":{"default":5,"type":"integer","minimum":0,"maximum":254}},"type":"object"}},"type":"object"}}},"key":{"type":"string","description":"the key of chash for dynamic load balancing"},"scheme":{"enum":["grpc","grpcs","http","https","tcp","tls","udp","kafka"],"default":"http","description":"The scheme of the upstream. For L7 proxy, it can be one of grpc/grpcs/http/https. For L4 proxy, it can be one of tcp/tls/udp. For specific protocols, it can be kafka."},"name":{"type":"string","minLength":1,"maxLength":100},"type":{"type":"string","default":"roundrobin","description":"algorithms of load balancing"},"retry_timeout":{"minimum":0,"type":"number"},"hash_on":{"type":"string","default":"vars","enum":["vars","header","cookie","consumer","vars_combinations"]},"tls":{"dependencies":{"client_cert":{"required":["client_key"]},"client_key":{"required":["client_cert"]},"client_cert_id":{"not":{"required":["client_cert","client_key"]}}},"type":"object","properties":{"client_cert":{"type":"string","minLength":128,"maxLength":65536},"verify":{"type":"boolean","default":false,"description":"Turn on server certificate verification, currently only kafka upstream is supported"},"client_cert_id":{"anyOf":[{"pattern":"^[a-zA-Z0-9-_.]+$","type":"string","minLength":1,"maxLength":64},{"minimum":1,"type":"integer"}]},"client_key":{"type":"string","minLength":128,"maxLength":65536}}},"pass_host":{"enum":["pass","node","rewrite"],"type":"string","default":"pass","description":"mod of host passing"},"upstream_host":{"pattern":"^\\*?[0-9a-zA-Z-._\\[\\]:]+$","type":"string"}}},"plugins":{"type":"object"},"name":{"type":"string","minLength":1,"maxLength":100},"methods":{"items":{"type":"string","enum":["GET","POST","PUT","DELETE","PATCH","HEAD","OPTIONS","CONNECT","TRACE","PURGE"],"description":"HTTP method"},"type":"array","uniqueItems":true},"hosts":{"items":{"pattern":"^\\*?[0-9a-zA-Z-._\\[\\]:]+$","type":"string"},"type":"array","minItems":1,"uniqueItems":true},"remote_addrs":{"items":{"type":"string","anyOf":[{"format":"ipv4","type":"string","title":"IPv4"},{"pattern":"^([0-9]|[1-9][0-9]|1[0-9]{2}|2[0-4][0-9]|25[0-5])\\.([0-9]|[1-9][0-9]|1[0-9]{2}|2[0-4][0-9]|25[0-5])\\.([0-9]|[1-9][0-9]|1[0-9]{2}|2[0-4][0-9]|25[0-5])\\.([0-9]|[1-9][0-9]|1[0-9]{2}|2[0-4][0-9]|25[0-5])/([12]?[0-9]|3[0-2])$","type":"string","title":"IPv4/CIDR"},{"format":"ipv6","type":"string","title":"IPv6"},{"pattern":"^([a-fA-F0-9]{0,4}:){1,8}(:[a-fA-F0-9]{0,4}){0,8}([a-fA-F0-9]{0,4})?/[0-9]{1,3}$","type":"string","title":"IPv6/CIDR"}],"description":"client IP"},"type":"array","minItems":1,"uniqueItems":true},"filter_func":{"pattern":"^function","type":"string","minLength":10},"vars":{"type":"array"},"script_id":{"anyOf":[{"pattern":"^[a-zA-Z0-9-_.]+$","type":"string","minLength":1,"maxLength":64},{"minimum":1,"type":"integer"}]},"remote_addr":{"type":"string","anyOf":[{"format":"ipv4","type":"string","title":"IPv4"},{"pattern":"^([0-9]|[1-9][0-9]|1[0-9]{2}|2[0-4][0-9]|25[0-5])\\.([0-9]|[1-9][0-9]|1[0-9]{2}|2[0-4][0-9]|25[0-5])\\.([0-9]|[1-9][0-9]|1[0-9]{2}|2[0-4][0-9]|25[0-5])\\.([0-9]|[1-9][0-9]|1[0-9]{2}|2[0-4][0-9]|25[0-5])/([12]?[0-9]|3[0-2])$","type":"string","title":"IPv4/CIDR"},{"format":"ipv6","type":"string","title":"IPv6"},{"pattern":"^([a-fA-F0-9]{0,4}:){1,8}(:[a-fA-F0-9]{0,4}){0,8}([a-fA-F0-9]{0,4})?/[0-9]{1,3}$","type":"string","title":"IPv6/CIDR"}],"description":"client IP"}}},"proto":{"additionalProperties":false,"type":"object","required":["content"],"properties":{"update_time":{"type":"integer"},"id":{"anyOf":[{"pattern":"^[a-zA-Z0-9-_.]+$","type":"string","minLength":1,"maxLength":64},{"minimum":1,"type":"integer"}]},"desc":{"maxLength":256,"type":"string"},"create_time":{"type":"integer"},"content":{"type":"string","minLength":1,"maxLength":1048576}}}},"stream_plugins":{"ip-restriction":{"schema":{"oneOf":[{"required":["whitelist"]},{"required":["blacklist"]}],"type":"object","$comment":"this is a mark for our injected plugin schema","properties":{"message":{"default":"Your IP address is not allowed","type":"string","minLength":1,"maxLength":1024},"blacklist":{"items":{"anyOf":[{"format":"ipv4","type":"string","title":"IPv4"},{"pattern":"^([0-9]|[1-9][0-9]|1[0-9]{2}|2[0-4][0-9]|25[0-5])\\.([0-9]|[1-9][0-9]|1[0-9]{2}|2[0-4][0-9]|25[0-5])\\.([0-9]|[1-9][0-9]|1[0-9]{2}|2[0-4][0-9]|25[0-5])\\.([0-9]|[1-9][0-9]|1[0-9]{2}|2[0-4][0-9]|25[0-5])/([12]?[0-9]|3[0-2])$","type":"string","title":"IPv4/CIDR"},{"format":"ipv6","type":"string","title":"IPv6"},{"pattern":"^([a-fA-F0-9]{0,4}:){1,8}(:[a-fA-F0-9]{0,4}){0,8}([a-fA-F0-9]{0,4})?/[0-9]{1,3}$","type":"string","title":"IPv6/CIDR"}]},"type":"array","minItems":1},"_meta":{"properties":{"disable":{"type":"boolean"},"priority":{"type":"integer","description":"priority of plugins by customized order"},"filter":{"type":"array","description":"filter determines whether the plugin needs to be executed at runtime"},"error_response":{"oneOf":[{"type":"string"},{"type":"object"}]}},"type":"object"},"whitelist":{"items":{"anyOf":[{"format":"ipv4","type":"string","title":"IPv4"},{"pattern":"^([0-9]|[1-9][0-9]|1[0-9]{2}|2[0-4][0-9]|25[0-5])\\.([0-9]|[1-9][0-9]|1[0-9]{2}|2[0-4][0-9]|25[0-5])\\.([0-9]|[1-9][0-9]|1[0-9]{2}|2[0-4][0-9]|25[0-5])\\.([0-9]|[1-9][0-9]|1[0-9]{2}|2[0-4][0-9]|25[0-5])/([12]?[0-9]|3[0-2])$","type":"string","title":"IPv4/CIDR"},{"format":"ipv6","type":"string","title":"IPv6"},{"pattern":"^([a-fA-F0-9]{0,4}:){1,8}(:[a-fA-F0-9]{0,4}){0,8}([a-fA-F0-9]{0,4})?/[0-9]{1,3}$","type":"string","title":"IPv6/CIDR"}]},"type":"array","minItems":1}}},"priority":3000,"version":0.1},"syslog":{"priority":401,"metadata_schema":{"properties":{"log_format":{"type":"object"}},"type":"object"},"schema":{"$comment":"this is a mark for our injected plugin schema","type":"object","required":["host","port"],"properties":{"host":{"type":"string"},"_meta":{"properties":{"disable":{"type":"boolean"},"priority":{"type":"integer","description":"priority of plugins by customized order"},"filter":{"type":"array","description":"filter determines whether the plugin needs to be executed at runtime"},"error_response":{"oneOf":[{"type":"string"},{"type":"object"}]}},"type":"object"},"inactive_timeout":{"type":"integer","minimum":1,"default":5},"max_retry_count":{"type":"integer","minimum":0,"default":0},"retry_delay":{"type":"integer","minimum":0,"default":1},"timeout":{"type":"integer","minimum":1,"default":3000},"log_format":{"type":"object"},"port":{"type":"integer"},"batch_max_size":{"type":"integer","minimum":1,"default":1000},"name":{"default":"stream sys logger","type":"string"},"buffer_duration":{"type":"integer","minimum":1,"default":60},"tls":{"default":false,"type":"boolean"},"sock_type":{"type":"string","default":"tcp","enum":["tcp","udp"]},"pool_size":{"type":"integer","minimum":5,"default":5},"flush_limit":{"type":"integer","minimum":1,"default":4096},"drop_limit":{"default":1048576,"type":"integer"}}},"version":0.1},"mqtt-proxy":{"schema":{"$comment":"this is a mark for our injected plugin schema","type":"object","required":["protocol_name","protocol_level"],"properties":{"protocol_level":{"type":"integer"},"_meta":{"properties":{"disable":{"type":"boolean"},"priority":{"type":"integer","description":"priority of plugins by customized order"},"filter":{"type":"array","description":"filter determines whether the plugin needs to be executed at runtime"},"error_response":{"oneOf":[{"type":"string"},{"type":"object"}]}},"type":"object"},"protocol_name":{"type":"string"}}},"priority":1000,"version":0.1},"limit-conn":{"schema":{"$comment":"this is a mark for our injected plugin schema","type":"object","required":["conn","burst","default_conn_delay","key"],"properties":{"conn":{"exclusiveMinimum":0,"type":"integer"},"_meta":{"properties":{"disable":{"type":"boolean"},"priority":{"type":"integer","description":"priority of plugins by customized order"},"filter":{"type":"array","description":"filter determines whether the plugin needs to be executed at runtime"},"error_response":{"oneOf":[{"type":"string"},{"type":"object"}]}},"type":"object"},"key_type":{"enum":["var","var_combination"],"default":"var","type":"string"},"burst":{"minimum":0,"type":"integer"},"default_conn_delay":{"exclusiveMinimum":0,"type":"number"},"only_use_default_delay":{"default":false,"type":"boolean"},"key":{"type":"string"}}},"priority":1003,"version":0.1}}}
